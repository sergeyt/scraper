import t from"lodash";import e from"lodash/trim";import n from"lodash/isEmpty";import r from"lodash/trimStart";import o from"lodash/trimEnd";import{Base64 as i}from"js-base64";import a from"isomorphic-unfetch";import c from"cheerio";var u=function(t){try{return!!t()}catch(t){return!0}},s={}.toString,l=function(t){return s.call(t).slice(8,-1)},f="".split,p=u(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==l(t)?f.call(t,""):Object(t)}:Object,h=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},d=function(t){return p(h(t))},v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function g(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},n.exports),n.exports}var y,m=function(t){return t&&t.Math==Math&&t},w=m("object"==typeof globalThis&&globalThis)||m("object"==typeof window&&window)||m("object"==typeof self&&self)||m("object"==typeof v&&v)||Function("return this")(),b=!u(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),x=function(t){return"object"==typeof t?null!==t:"function"==typeof t},S=w.document,E=x(S)&&x(S.createElement),O=function(t){return E?S.createElement(t):{}},j=!b&&!u(function(){return 7!=Object.defineProperty(O("div"),"a",{get:function(){return 7}}).a}),P=function(t){if(!x(t))throw TypeError(String(t)+" is not an object");return t},T=function(t,e){if(!x(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!x(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!x(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!x(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},A=Object.defineProperty,R={f:b?A:function(t,e,n){if(P(t),e=T(e,!0),P(n),j)try{return A(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},I=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},C=b?function(t,e,n){return R.f(t,e,I(1,n))}:function(t,e,n){return t[e]=n,t},_=function(t,e){try{C(w,t,e)}catch(n){w[t]=e}return e},$=w["__core-js_shared__"]||_("__core-js_shared__",{}),k=g(function(t){(t.exports=function(t,e){return $[t]||($[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})}),L={}.hasOwnProperty,M=function(t,e){return L.call(t,e)},N=0,U=Math.random(),D=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++N+U).toString(36)},F=!!Object.getOwnPropertySymbols&&!u(function(){return!String(Symbol())}),W=F&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,G=k("wks"),V=w.Symbol,q=W?V:V&&V.withoutSetter||D,B=function(t){return M(G,t)||(G[t]=F&&M(V,t)?V[t]:q("Symbol."+t)),G[t]},H=Math.ceil,K=Math.floor,X=function(t){return isNaN(t=+t)?0:(t>0?K:H)(t)},Y=Math.min,z=function(t){return t>0?Y(X(t),9007199254740991):0},J=Math.max,Q=Math.min,Z=function(t){return function(e,n,r){var o,i=d(e),a=z(i.length),c=function(t,e){var n=X(t);return n<0?J(n+e,0):Q(n,e)}(r,a);if(t&&n!=n){for(;a>c;)if((o=i[c++])!=o)return!0}else for(;a>c;c++)if((t||c in i)&&i[c]===n)return t||c||0;return!t&&-1}},tt={includes:Z(!0),indexOf:Z(!1)},et={},nt=tt.indexOf,rt=function(t,e){var n,r=d(t),o=0,i=[];for(n in r)!M(et,n)&&M(r,n)&&i.push(n);for(;e.length>o;)M(r,n=e[o++])&&(~nt(i,n)||i.push(n));return i},ot=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],it=Object.keys||function(t){return rt(t,ot)},at=b?Object.defineProperties:function(t,e){P(t);for(var n,r=it(e),o=r.length,i=0;o>i;)R.f(t,n=r[i++],e[n]);return t},ct=w,ut=function(t){return"function"==typeof t?t:void 0},st=function(t,e){return arguments.length<2?ut(ct[t])||ut(w[t]):ct[t]&&ct[t][e]||w[t]&&w[t][e]},lt=st("document","documentElement"),ft=k("keys"),pt=function(t){return ft[t]||(ft[t]=D(t))},ht=pt("IE_PROTO"),dt=function(){},vt=function(t){return"<script>"+t+"<\/script>"},gt=function(){try{y=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;gt=y?function(t){t.write(vt("")),t.close();var e=t.parentWindow.Object;return t=null,e}(y):((e=O("iframe")).style.display="none",lt.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(vt("document.F=Object")),t.close(),t.F);for(var n=ot.length;n--;)delete gt.prototype[ot[n]];return gt()};et[ht]=!0;var yt=Object.create||function(t,e){var n;return null!==t?(dt.prototype=P(t),n=new dt,dt.prototype=null,n[ht]=t):n=gt(),void 0===e?n:at(n,e)},mt=B("unscopables"),wt=Array.prototype;null==wt[mt]&&R.f(wt,mt,{configurable:!0,value:yt(null)});var bt=function(t){wt[mt][t]=!0},xt={},St=Function.toString;"function"!=typeof $.inspectSource&&($.inspectSource=function(t){return St.call(t)});var Et,Ot,jt,Pt=$.inspectSource,Tt=w.WeakMap;if("function"==typeof Tt&&/native code/.test(Pt(Tt))){var At=new(0,w.WeakMap),Rt=At.get,It=At.has,Ct=At.set;Et=function(t,e){return Ct.call(At,t,e),e},Ot=function(t){return Rt.call(At,t)||{}},jt=function(t){return It.call(At,t)}}else{var _t=pt("state");et[_t]=!0,Et=function(t,e){return C(t,_t,e),e},Ot=function(t){return M(t,_t)?t[_t]:{}},jt=function(t){return M(t,_t)}}var $t,kt,Lt,Mt={set:Et,get:Ot,has:jt,enforce:function(t){return jt(t)?Ot(t):Et(t,{})},getterFor:function(t){return function(e){var n;if(!x(e)||(n=Ot(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}},Nt={}.propertyIsEnumerable,Ut=Object.getOwnPropertyDescriptor,Dt={f:Ut&&!Nt.call({1:2},1)?function(t){var e=Ut(this,t);return!!e&&e.enumerable}:Nt},Ft=Object.getOwnPropertyDescriptor,Wt={f:b?Ft:function(t,e){if(t=d(t),e=T(e,!0),j)try{return Ft(t,e)}catch(t){}if(M(t,e))return I(!Dt.f.call(t,e),t[e])}},Gt=g(function(t){var e=Mt.get,n=Mt.enforce,r=String(String).split("String");(t.exports=function(t,e,o,i){var a=!!i&&!!i.unsafe,c=!!i&&!!i.enumerable,u=!!i&&!!i.noTargetGet;"function"==typeof o&&("string"!=typeof e||M(o,"name")||C(o,"name",e),n(o).source=r.join("string"==typeof e?e:"")),t!==w?(a?!u&&t[e]&&(c=!0):delete t[e],c?t[e]=o:C(t,e,o)):c?t[e]=o:_(e,o)})(Function.prototype,"toString",function(){return"function"==typeof this&&e(this).source||Pt(this)})}),Vt=ot.concat("length","prototype"),qt={f:Object.getOwnPropertyNames||function(t){return rt(t,Vt)}},Bt={f:Object.getOwnPropertySymbols},Ht=st("Reflect","ownKeys")||function(t){var e=qt.f(P(t)),n=Bt.f;return n?e.concat(n(t)):e},Kt=function(t,e){for(var n=Ht(e),r=R.f,o=Wt.f,i=0;i<n.length;i++){var a=n[i];M(t,a)||r(t,a,o(e,a))}},Xt=/#|\.prototype\./,Yt=function(t,e){var n=Jt[zt(t)];return n==Zt||n!=Qt&&("function"==typeof e?u(e):!!e)},zt=Yt.normalize=function(t){return String(t).replace(Xt,".").toLowerCase()},Jt=Yt.data={},Qt=Yt.NATIVE="N",Zt=Yt.POLYFILL="P",te=Yt,ee=Wt.f,ne=function(t,e){var n,r,o,i,a,c=t.target,u=t.global,s=t.stat;if(n=u?w:s?w[c]||_(c,{}):(w[c]||{}).prototype)for(r in e){if(i=e[r],o=t.noTargetGet?(a=ee(n,r))&&a.value:n[r],!te(u?r:c+(s?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Kt(i,o)}(t.sham||o&&o.sham)&&C(i,"sham",!0),Gt(n,r,i,t)}},re=function(t){return Object(h(t))},oe=!u(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),ie=pt("IE_PROTO"),ae=Object.prototype,ce=oe?Object.getPrototypeOf:function(t){return t=re(t),M(t,ie)?t[ie]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ae:null},ue=B("iterator"),se=!1;[].keys&&("next"in(Lt=[].keys())?(kt=ce(ce(Lt)))!==Object.prototype&&($t=kt):se=!0),null==$t&&($t={}),M($t,ue)||C($t,ue,function(){return this});var le={IteratorPrototype:$t,BUGGY_SAFARI_ITERATORS:se},fe=R.f,pe=B("toStringTag"),he=function(t,e,n){t&&!M(t=n?t:t.prototype,pe)&&fe(t,pe,{configurable:!0,value:e})},de=le.IteratorPrototype,ve=function(){return this},ge=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return P(n),function(t){if(!x(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(r),e?t.call(n,r):n.__proto__=r,n}}():void 0),ye=le.IteratorPrototype,me=le.BUGGY_SAFARI_ITERATORS,we=B("iterator"),be=function(){return this},xe=Mt.set,Se=Mt.getterFor("Array Iterator"),Ee=function(t,e,n,r,o,i,a){!function(t,e,n){t.prototype=yt(de,{next:I(1,function(){var t=Se(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}})}),he(t,"Array Iterator",!1),xt["Array Iterator"]=ve}(n);var c,u,s,l=function(t){if("values"===t&&d)return d;if(!me&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},f=!1,p=t.prototype,h=p[we]||p["@@iterator"]||p.values,d=!me&&h||l("values"),v=p.entries||h;if(v&&(c=ce(v.call(new t)),ye!==Object.prototype&&c.next&&(ce(c)!==ye&&(ge?ge(c,ye):"function"!=typeof c[we]&&C(c,we,be)),he(c,"Array Iterator",!0))),h&&"values"!==h.name&&(f=!0,d=function(){return h.call(this)}),p[we]!==d&&C(p,we,d),xt.Array=d,void(u={values:l("values"),keys:l("keys"),entries:l("entries")}))for(s in u)(me||f||!(s in p))&&Gt(p,s,u[s]);else ne({target:"Array",proto:!0,forced:me||f},u);return u}(Array,0,function(t,e){xe(this,{type:"Array Iterator",target:d(t),index:0,kind:e})});xt.Arguments=xt.Array,bt("keys"),bt("values"),bt("entries");var Oe=w.Promise,je=B("species"),Pe=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},Te=B("iterator"),Ae=Array.prototype,Re=function(t,e,n){if(Pe(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}},Ie={};Ie[B("toStringTag")]="z";var Ce="[object z]"===String(Ie),_e=B("toStringTag"),$e="Arguments"==l(function(){return arguments}()),ke=Ce?l:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),_e))?n:$e?l(e):"Object"==(r=l(e))&&"function"==typeof e.callee?"Arguments":r},Le=B("iterator"),Me=function(t,e,n,r){try{return r?e(P(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&P(o.call(t)),e}},Ne=g(function(t){var e=function(t,e){this.stopped=t,this.result=e};(t.exports=function(t,n,r,o,i){var a,c,u,s,l,f,p,h,d=Re(n,r,o?2:1);if(i)a=t;else{if("function"!=typeof(c=function(t){if(null!=t)return t[Le]||t["@@iterator"]||xt[ke(t)]}(t)))throw TypeError("Target is not iterable");if(void 0!==(h=c)&&(xt.Array===h||Ae[Te]===h)){for(u=0,s=z(t.length);s>u;u++)if((l=o?d(P(p=t[u])[0],p[1]):d(t[u]))&&l instanceof e)return l;return new e(!1)}a=c.call(t)}for(f=a.next;!(p=f.call(a)).done;)if("object"==typeof(l=Me(a,d,p.value,o))&&l&&l instanceof e)return l;return new e(!1)}).stop=function(t){return new e(!0,t)}}),Ue=B("iterator"),De=!1;try{var Fe=0,We={next:function(){return{done:!!Fe++}},return:function(){De=!0}};We[Ue]=function(){return this},Array.from(We,function(){throw 2})}catch(t){}var Ge,Ve,qe,Be=B("species"),He=function(t,e){var n,r=P(t).constructor;return void 0===r||null==(n=P(r)[Be])?e:Pe(n)},Ke=st("navigator","userAgent")||"",Xe=/(iphone|ipod|ipad).*applewebkit/i.test(Ke),Ye=w.location,ze=w.setImmediate,Je=w.clearImmediate,Qe=w.process,Ze=w.MessageChannel,tn=w.Dispatch,en=0,nn={},rn=function(t){if(nn.hasOwnProperty(t)){var e=nn[t];delete nn[t],e()}},on=function(t){return function(){rn(t)}},an=function(t){rn(t.data)},cn=function(t){w.postMessage(t+"",Ye.protocol+"//"+Ye.host)};ze&&Je||(ze=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return nn[++en]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},Ge(en),en},Je=function(t){delete nn[t]},"process"==l(Qe)?Ge=function(t){Qe.nextTick(on(t))}:tn&&tn.now?Ge=function(t){tn.now(on(t))}:Ze&&!Xe?(qe=(Ve=new Ze).port2,Ve.port1.onmessage=an,Ge=Re(qe.postMessage,qe,1)):!w.addEventListener||"function"!=typeof postMessage||w.importScripts||u(cn)||"file:"===Ye.protocol?Ge="onreadystatechange"in O("script")?function(t){lt.appendChild(O("script")).onreadystatechange=function(){lt.removeChild(this),rn(t)}}:function(t){setTimeout(on(t),0)}:(Ge=cn,w.addEventListener("message",an,!1)));var un,sn,ln,fn,pn,hn,dn,vn,gn={set:ze,clear:Je},yn=Wt.f,mn=gn.set,wn=w.MutationObserver||w.WebKitMutationObserver,bn=w.process,xn=w.Promise,Sn="process"==l(bn),En=yn(w,"queueMicrotask"),On=En&&En.value;On||(un=function(){var t,e;for(Sn&&(t=bn.domain)&&t.exit();sn;){e=sn.fn,sn=sn.next;try{e()}catch(t){throw sn?fn():ln=void 0,t}}ln=void 0,t&&t.enter()},Sn?fn=function(){bn.nextTick(un)}:wn&&!Xe?(pn=!0,hn=document.createTextNode(""),new wn(un).observe(hn,{characterData:!0}),fn=function(){hn.data=pn=!pn}):xn&&xn.resolve?(dn=xn.resolve(void 0),vn=dn.then,fn=function(){vn.call(dn,un)}):fn=function(){mn.call(w,un)});var jn,Pn,Tn=On||function(t){var e={fn:t,next:void 0};ln&&(ln.next=e),sn||(sn=e,fn()),ln=e},An=function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=Pe(e),this.reject=Pe(n)},Rn={f:function(t){return new An(t)}},In=function(t,e){if(P(t),x(e)&&e.constructor===t)return e;var n=Rn.f(t);return(0,n.resolve)(e),n.promise},Cn=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},_n=w.process,$n=_n&&_n.versions,kn=$n&&$n.v8;kn?Pn=(jn=kn.split("."))[0]+jn[1]:Ke&&(!(jn=Ke.match(/Edge\/(\d+)/))||jn[1]>=74)&&(jn=Ke.match(/Chrome\/(\d+)/))&&(Pn=jn[1]);var Ln,Mn,Nn,Un,Dn,Fn=Pn&&+Pn,Wn=gn.set,Gn=B("species"),Vn=Mt.get,qn=Mt.set,Bn=Mt.getterFor("Promise"),Hn=Oe,Kn=w.TypeError,Xn=w.document,Yn=w.process,zn=st("fetch"),Jn=Rn.f,Qn=Jn,Zn="process"==l(Yn),tr=!!(Xn&&Xn.createEvent&&w.dispatchEvent),er=te("Promise",function(){if(Pt(Hn)===String(Hn)){if(66===Fn)return!0;if(!Zn&&"function"!=typeof PromiseRejectionEvent)return!0}if(Fn>=51&&/native code/.test(Hn))return!1;var t=Hn.resolve(1),e=function(t){t(function(){},function(){})};return(t.constructor={})[Gn]=e,!(t.then(function(){})instanceof e)}),nr=er||!function(t,e){if(!De)return!1;var n=!1;try{var r={};r[Ue]=function(){return{next:function(){return{done:n=!0}}}},Hn.all(r).catch(function(){})}catch(t){}return n}(),rr=function(t){var e;return!(!x(t)||"function"!=typeof(e=t.then))&&e},or=function(t,e,n){if(!e.notified){e.notified=!0;var r=e.reactions;Tn(function(){for(var o=e.value,i=1==e.state,a=0;r.length>a;){var c,u,s,l=r[a++],f=i?l.ok:l.fail,p=l.resolve,h=l.reject,d=l.domain;try{f?(i||(2===e.rejection&&ur(t,e),e.rejection=1),!0===f?c=o:(d&&d.enter(),c=f(o),d&&(d.exit(),s=!0)),c===l.promise?h(Kn("Promise-chain cycle")):(u=rr(c))?u.call(c,p,h):p(c)):h(o)}catch(t){d&&!s&&d.exit(),h(t)}}e.reactions=[],e.notified=!1,n&&!e.rejection&&ar(t,e)})}},ir=function(t,e,n){var r,o;tr?((r=Xn.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),w.dispatchEvent(r)):r={promise:e,reason:n},(o=w["on"+t])?o(r):"unhandledrejection"===t&&function(t,e){var n=w.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}("Unhandled promise rejection",n)},ar=function(t,e){Wn.call(w,function(){var n,r=e.value;if(cr(e)&&(n=Cn(function(){Zn?Yn.emit("unhandledRejection",r,t):ir("unhandledrejection",t,r)}),e.rejection=Zn||cr(e)?2:1,n.error))throw n.value})},cr=function(t){return 1!==t.rejection&&!t.parent},ur=function(t,e){Wn.call(w,function(){Zn?Yn.emit("rejectionHandled",t):ir("rejectionhandled",t,e.value)})},sr=function(t,e,n,r){return function(o){t(e,n,o,r)}},lr=function(t,e,n,r){e.done||(e.done=!0,r&&(e=r),e.value=n,e.state=2,or(t,e,!0))},fr=function(t,e,n,r){if(!e.done){e.done=!0,r&&(e=r);try{if(t===n)throw Kn("Promise can't be resolved itself");var o=rr(n);o?Tn(function(){var r={done:!1};try{o.call(n,sr(fr,t,r,e),sr(lr,t,r,e))}catch(n){lr(t,r,n,e)}}):(e.value=n,e.state=1,or(t,e,!1))}catch(n){lr(t,{done:!1},n,e)}}};er&&(Hn=function(t){!function(t,e,n){if(!(t instanceof Hn))throw TypeError("Incorrect Promise invocation")}(this),Pe(t),Ln.call(this);var e=Vn(this);try{t(sr(fr,this,e),sr(lr,this,e))}catch(t){lr(this,e,t)}},(Ln=function(t){qn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(t,e,n){for(var r in e)Gt(t,r,e[r],void 0);return t}(Hn.prototype,{then:function(t,e){var n=Bn(this),r=Jn(He(this,Hn));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=Zn?Yn.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&or(this,n,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),Mn=function(){var t=new Ln,e=Vn(t);this.promise=t,this.resolve=sr(fr,t,e),this.reject=sr(lr,t,e)},Rn.f=Jn=function(t){return t===Hn||t===Nn?new Mn(t):Qn(t)},"function"==typeof Oe&&(Un=Oe.prototype.then,Gt(Oe.prototype,"then",function(t,e){var n=this;return new Hn(function(t,e){Un.call(n,t,e)}).then(t,e)},{unsafe:!0}),"function"==typeof zn&&ne({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return In(Hn,zn.apply(w,arguments))}}))),ne({global:!0,wrap:!0,forced:er},{Promise:Hn}),he(Hn,"Promise",!1),Dn=st("Promise"),b&&Dn&&!Dn[je]&&(0,R.f)(Dn,je,{configurable:!0,get:function(){return this}}),Nn=st("Promise"),ne({target:"Promise",stat:!0,forced:er},{reject:function(t){var e=Jn(this);return e.reject.call(void 0,t),e.promise}}),ne({target:"Promise",stat:!0,forced:er},{resolve:function(t){return In(this,t)}}),ne({target:"Promise",stat:!0,forced:nr},{all:function(t){var e=this,n=Jn(e),r=n.resolve,o=n.reject,i=Cn(function(){var n=Pe(e.resolve),i=[],a=0,c=1;Ne(t,function(t){var u=a++,s=!1;i.push(void 0),c++,n.call(e,t).then(function(t){s||(s=!0,i[u]=t,--c||r(i))},o)}),--c||r(i)});return i.error&&o(i.value),n.promise},race:function(t){var e=this,n=Jn(e),r=n.reject,o=Cn(function(){var o=Pe(e.resolve);Ne(t,function(t){o.call(e,t).then(n.resolve,r)})});return o.error&&r(o.value),n.promise}});var pr,hr=B("match"),dr=function(t){var e;return x(t)&&(void 0!==(e=t[hr])?!!e:"RegExp"==l(t))},vr=function(t){if(dr(t))throw TypeError("The method doesn't accept regular expressions");return t},gr=B("match"),yr=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[gr]=!1,"/./"[t](e)}catch(t){}}return!1},mr=Wt.f,wr="".startsWith,br=Math.min,xr=yr("startsWith"),Sr=!(xr||(pr=mr(String.prototype,"startsWith"),!pr||pr.writable));ne({target:"String",proto:!0,forced:!Sr&&!xr},{startsWith:function(t){var e=String(h(this));vr(t);var n=z(br(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return wr?wr.call(e,r,n):e.slice(n,n+r.length)===r}});var Er={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Or=B("iterator"),jr=B("toStringTag"),Pr=Ee.values;for(var Tr in Er){var Ar=w[Tr],Rr=Ar&&Ar.prototype;if(Rr){if(Rr[Or]!==Pr)try{C(Rr,Or,Pr)}catch(t){Rr[Or]=Pr}if(Rr[jr]||C(Rr,jr,Tr),Er[Tr])for(var Ir in Ee)if(Rr[Ir]!==Ee[Ir])try{C(Rr,Ir,Ee[Ir])}catch(t){Rr[Ir]=Ee[Ir]}}}var Cr=function(){var t=P(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e},_r=RegExp.prototype,$r=_r.toString;(u(function(){return"/a/b"!=$r.call({source:"a",flags:"b"})})||"toString"!=$r.name)&&Gt(RegExp.prototype,"toString",function(){var t=P(this),e=String(t.source),n=t.flags;return"/"+e+"/"+String(void 0===n&&t instanceof RegExp&&!("flags"in _r)?Cr.call(t):n)},{unsafe:!0});var kr="\t\n\v\f\r                　\u2028\u2029\ufeff",Lr="["+kr+"]",Mr=RegExp("^"+Lr+Lr+"*"),Nr=RegExp(Lr+Lr+"*$"),Ur=function(t){return function(e){var n=String(h(e));return 1&t&&(n=n.replace(Mr,"")),2&t&&(n=n.replace(Nr,"")),n}},Dr=(Ur(1),Ur(2),Ur(3));function Fr(t){return e(null==t?void 0:t.trim(),"​")}ne({target:"String",proto:!0,forced:u(function(){return!!kr.trim()||"​᠎"!="​᠎".trim()||"trim"!==kr.trim.name})},{trim:function(){return Dr(this)}});const Wr=!("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))&&"undefined"!=typeof window;function Gr(t,e){return RegExp(t,e)}var Vr,qr,Br={UNSUPPORTED_Y:u(function(){var t=Gr("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),BROKEN_CARET:u(function(){var t=Gr("^r","gy");return t.lastIndex=2,null!=t.exec("str")})},Hr=RegExp.prototype.exec,Kr=String.prototype.replace,Xr=Hr,Yr=(qr=/b*/g,Hr.call(Vr=/a/,"a"),Hr.call(qr,"a"),0!==Vr.lastIndex||0!==qr.lastIndex),zr=Br.UNSUPPORTED_Y||Br.BROKEN_CARET,Jr=void 0!==/()??/.exec("")[1];(Yr||Jr||zr)&&(Xr=function(t){var e,n,r,o,i=this,a=zr&&i.sticky,c=Cr.call(i),u=i.source,s=0,l=t;return a&&(-1===(c=c.replace("y","")).indexOf("g")&&(c+="g"),l=String(t).slice(i.lastIndex),i.lastIndex>0&&(!i.multiline||i.multiline&&"\n"!==t[i.lastIndex-1])&&(u="(?: "+u+")",l=" "+l,s++),n=new RegExp("^(?:"+u+")",c)),Jr&&(n=new RegExp("^"+u+"$(?!\\s)",c)),Yr&&(e=i.lastIndex),r=Hr.call(a?n:i,l),a?r?(r.input=r.input.slice(s),r[0]=r[0].slice(s),r.index=i.lastIndex,i.lastIndex+=r[0].length):i.lastIndex=0:Yr&&r&&(i.lastIndex=i.global?r.index+r[0].length:e),Jr&&r&&r.length>1&&Kr.call(r[0],n,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)}),r});var Qr=Xr;ne({target:"RegExp",proto:!0,forced:/./.exec!==Qr},{exec:Qr});var Zr=B("species"),to=!u(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),eo="$0"==="a".replace(/./,"$0"),no=B("replace"),ro=!!/./[no]&&""===/./[no]("a","$0"),oo=!u(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}),io=function(t,e,n,r){var o=B(t),i=!u(function(){var e={};return e[o]=function(){return 7},7!=""[t](e)}),a=i&&!u(function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[Zr]=function(){return n},n.flags="",n[o]=/./[o]),n.exec=function(){return e=!0,null},n[o](""),!e});if(!i||!a||"replace"===t&&(!to||!eo||ro)||"split"===t&&!oo){var c=/./[o],s=n(o,""[t],function(t,e,n,r,o){return e.exec===Qr?i&&!o?{done:!0,value:c.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}},{REPLACE_KEEPS_$0:eo,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:ro}),l=s[1];Gt(String.prototype,t,s[0]),Gt(RegExp.prototype,o,2==e?function(t,e){return l.call(t,this,e)}:function(t){return l.call(t,this)})}r&&C(RegExp.prototype[o],"sham",!0)},ao=function(t){return function(e,n){var r,o,i=String(h(e)),a=X(n),c=i.length;return a<0||a>=c?t?"":void 0:(r=i.charCodeAt(a))<55296||r>56319||a+1===c||(o=i.charCodeAt(a+1))<56320||o>57343?t?i.charAt(a):r:t?i.slice(a,a+2):o-56320+(r-55296<<10)+65536}},co=(ao(!1),ao(!0)),uo=function(t,e,n){return e+(n?co(t,e).length:1)},so=function(t,e){var n=t.exec;if("function"==typeof n){var r=n.call(t,e);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==l(t))throw TypeError("RegExp#exec called on incompatible receiver");return Qr.call(t,e)},lo=Math.max,fo=Math.min,po=Math.floor,ho=/\$([$&'`]|\d\d?|<[^>]*>)/g,vo=/\$([$&'`]|\d\d?)/g;io("replace",2,function(t,e,n,r){var o=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,i=r.REPLACE_KEEPS_$0,a=o?"$":"$0";return[function(n,r){var o=h(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,o,r):e.call(String(o),n,r)},function(t,r){if(!o&&i||"string"==typeof r&&-1===r.indexOf(a)){var u=n(e,t,this,r);if(u.done)return u.value}var s=P(t),l=String(this),f="function"==typeof r;f||(r=String(r));var p=s.global;if(p){var h=s.unicode;s.lastIndex=0}for(var d=[];;){var v=so(s,l);if(null===v)break;if(d.push(v),!p)break;""===String(v[0])&&(s.lastIndex=uo(l,z(s.lastIndex),h))}for(var g,y="",m=0,w=0;w<d.length;w++){v=d[w];for(var b=String(v[0]),x=lo(fo(X(v.index),l.length),0),S=[],E=1;E<v.length;E++)S.push(void 0===(g=v[E])?g:String(g));var O=v.groups;if(f){var j=[b].concat(S,x,l);void 0!==O&&j.push(O);var T=String(r.apply(void 0,j))}else T=c(b,l,x,S,O,r);x>=m&&(y+=l.slice(m,x)+T,m=x+b.length)}return y+l.slice(m)}];function c(t,n,r,o,i,a){var c=r+t.length,u=o.length,s=vo;return void 0!==i&&(i=re(i),s=ho),e.call(a,s,function(e,a){var s;switch(a.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=i[a.slice(1,-1)];break;default:var l=+a;if(0===l)return e;if(l>u){var f=po(l/10);return 0===f?e:f<=u?void 0===o[f-1]?a.charAt(1):o[f-1]+a.charAt(1):e}s=o[l-1]}return void 0===s?"":s})}});var go,yo=Object.defineProperty,mo={},wo=function(t){throw t},bo=tt.indexOf,xo=[].indexOf,So=!!xo&&1/[1].indexOf(1,-0)<0,Eo=!!(go=[].indexOf)&&u(function(){go.call(null,function(){throw 1},1)}),Oo=function(t,e){if(M(mo,"indexOf"))return mo.indexOf;e||(e={});var n=[].indexOf,r=!!M(e,"ACCESSORS")&&e.ACCESSORS,o=M(e,0)?e[0]:wo,i=M(e,1)?e[1]:void 0;return mo.indexOf=!!n&&!u(function(){if(r&&!b)return!0;var t={length:-1};r?yo(t,1,{enumerable:!0,get:wo}):t[1]=1,n.call(t,o,i)})}(0,{ACCESSORS:!0,1:0});ne({target:"Array",proto:!0,forced:So||!Eo||!Oo},{indexOf:function(t){return So?xo.apply(this,arguments)||0:bo(this,t,arguments.length>1?arguments[1]:void 0)}});var jo=Object.assign,Po=Object.defineProperty,To=!jo||u(function(){if(b&&1!==jo({b:1},jo(Po({},"a",{enumerable:!0,get:function(){Po(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=jo({},t)[n]||"abcdefghijklmnopqrst"!=it(jo({},e)).join("")})?function(t,e){for(var n=re(t),r=arguments.length,o=1,i=Bt.f,a=Dt.f;r>o;)for(var c,u=p(arguments[o++]),s=i?it(u).concat(i(u)):it(u),l=s.length,f=0;l>f;)c=s[f++],b&&!a.call(u,c)||(n[c]=u[c]);return n}:jo;ne({target:"Object",stat:!0,forced:Object.assign!==To},{assign:To});var Ao=Wt.f,Ro="".endsWith,Io=Math.min,Co=yr("endsWith"),_o=!Co&&!!function(){var t=Ao(String.prototype,"endsWith");return t&&!t.writable}();ne({target:"String",proto:!0,forced:!_o&&!Co},{endsWith:function(t){var e=String(h(this));vr(t);var n=arguments.length>1?arguments[1]:void 0,r=z(e.length),o=void 0===n?r:Io(z(n),r),i=String(t);return Ro?Ro.call(e,i,o):e.slice(o-i.length,o)===i}});var $o=[].push,ko=Math.min,Lo=!u(function(){return!RegExp(4294967295,"y")});io("split",2,function(t,e,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var r=String(h(this)),o=void 0===n?4294967295:n>>>0;if(0===o)return[];if(void 0===t)return[r];if(!dr(t))return e.call(r,t,o);for(var i,a,c,u=[],s=0,l=new RegExp(t.source,(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":"")+"g");(i=Qr.call(l,r))&&!((a=l.lastIndex)>s&&(u.push(r.slice(s,i.index)),i.length>1&&i.index<r.length&&$o.apply(u,i.slice(1)),c=i[0].length,s=a,u.length>=o));)l.lastIndex===i.index&&l.lastIndex++;return s===r.length?!c&&l.test("")||u.push(""):u.push(r.slice(s)),u.length>o?u.slice(0,o):u}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var o=h(this),i=null==e?void 0:e[t];return void 0!==i?i.call(e,o,n):r.call(String(o),e,n)},function(t,o){var i=n(r,t,this,o,r!==e);if(i.done)return i.value;var a=P(t),c=String(this),u=He(a,RegExp),s=a.unicode,l=new u(Lo?a:"^(?:"+a.source+")",(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Lo?"y":"g")),f=void 0===o?4294967295:o>>>0;if(0===f)return[];if(0===c.length)return null===so(l,c)?[c]:[];for(var p=0,h=0,d=[];h<c.length;){l.lastIndex=Lo?h:0;var v,g=so(l,Lo?c:c.slice(h));if(null===g||(v=ko(z(l.lastIndex+(Lo?0:h)),c.length))===p)h=uo(c,h,s);else{if(d.push(c.slice(p,h)),d.length===f)return d;for(var y=1;y<=g.length-1;y++)if(d.push(g[y]),d.length===f)return d;h=p=v}}return d.push(c.slice(p)),d}]},!Lo);const Mo=encodeURIComponent;function No(t){return t&&t.startsWith("'")?t.substr(1,t.length-2):t}const Uo={type:"audio",name:"forvo",url:"https://forvo.com",makeUrl:({text:t,lang:e})=>`https://ru.forvo.com/word/${Mo(t)}/#${e}`,plan:[{selector:"article.pronunciations ul.show-all-pronunciations li",parse:async t=>{const e=(await t.$$("span.play"))[0];if(!e)return;const a=function(t){if(!t)return;const e=t.indexOf("("),n=t.indexOf(")");return{name:t.substr(0,e),args:t.substr(e+1,n-e-1).split(",").map(No)}}(await e.getAttribute("onclick"));if(!a||"Play"!==a.name)return;const c="https://audio00.forvo.com/audios/mp3/"+i.decode(a.args[4]);if(!c.endsWith(".mp3"))return;const u={url:c},s=(await t.$$("span.ofLink"))[0];if(s){const t=await s.getAttribute("data-p2");t&&(u.author=t)}const l=(await t.$$("span.from"))[0];if(l){const t=function(t){if(!t)return;const e=(t=o(r(t,"("),")")).split(",");if(n(e))return;const i={gender:(a=e[0],"женщина"===(a=Fr(a))?"f":"мужчина"===a?"m":a)};var a;return 2===e.length&&(i.country=function(t){return Fr(t)}(e[1])),i}(await l.textContent());t&&Object.assign(u,t)}return[{audio:u}]}}]},Do={type:"audio",name:"howjsay",url:"https://howjsay.com",getData:async({text:t})=>({audio:[{url:`https://howjsay.com/mp3/${encodeURIComponent(t)}.mp3`}]})};class Fo{constructor(t,e){this.$=t,this.elem=e}async $$(t){const e=this.elem.find(t),n=[];return e.each((t,e)=>{n.push(new Fo(this.$,this.$(e)))}),n}async getAttribute(t){return this.elem.attr(t)}async textContent(){return this.elem.text()}}class Wo{constructor(t){this.$=c.load(t)}$$(t){const e=this.$(t),n=[];return e.each((t,e)=>{n.push(new Fo(this.$,this.$(e)))}),Promise.resolve(n)}close(){return Promise.resolve(void 0)}}async function Go(t){Wr&&(t="https://api.allorigins.win/raw?url="+encodeURIComponent(t));const e=await a(t,{headers:{"User-Agent":"lingua-bot",Accept:"text/html,application/xhtml+xml"}});if(!e.ok)throw new Error(e.statusText);const n=await e.text();return new Wo(n)}class Vo{constructor(t,e){this.page=t,this.elem=e}async $$(t){return(await this.elem.$$(t)).map(t=>new Vo(this.page,t))}getAttribute(t){return this.elem.getAttribute(t)}textContent(){return this.elem.textContent()}}class qo{constructor(t,e){this.browser=t,this.page=e}async $$(t){try{await this.page.waitForSelector(t,{timeout:5e3})}catch(t){}return(await this.page.$$(t)).map(t=>new Vo(this.page,t))}async close(){await this.page.close(),await this.browser.close()}}const Bo=[{type:"visual",name:"unsplash",url:"https://unsplash.com",makeUrl:({text:t})=>"/s/photos/"+t.replace(" ","-"),plan:[{selector:'div[data-test="search-photos-route"] figure img',exclude:["^https://images.unsplash.com/profile-"],visual:["@src"]}]},{type:"universal",engine:"playwright",name:"wordnik",url:"https://www.wordnik.com",makeUrl:({text:t})=>"/words/"+t,plan:[{selector:".flickr-module .thumbs img",visual:["@src"]}]},{type:"universal",name:"macmillan",url:"https://www.macmillandictionary.com",makeUrl:({text:t})=>"/dictionary/british/"+t,plan:[{selector:".PRON",term:"transcription"},{selector:".PART-OF-SPEECH",term:"tag"},{selector:".SYNTAX-CODING",term:"tag"},{selector:".DEFINITION",term:"definition"},{selector:".EXAMPLES",term:"in"},{selector:".PHR-XREF",term:"in"},{selector:".synonyms .theslink",exclude:["..."],term:"synonym"},{selector:".audio_play_button",audio:["@data-src-mp3","@data-src-ogg"]}]},Uo,Do];function Ho(e){return async({text:n,lang:r})=>{const o={text:n,lang:r||"en"};if(e.getData)try{const t=await e.getData(o);return{source:{name:e.name,url:e.url},data:t}}catch(t){return console.log("error",e.name,t),{source:{name:e.name,url:e.url},error:t}}let i=e.makeUrl(o);i.startsWith("/")&&(i=e.url+i);try{const n=await function(t,e){return"playwright"===t?async function(t){if(Wr)return await Go(t);const{chromium:e}=require("playwright"),n=await e.launch(),r=await n.newPage();return await r.goto(t),new qo(n,r)}(e):Go(e)}(e.engine,i);return async function(e,n,r){const o={},i=t=>{t&&!o[t]&&(o[t]=new Set)},a=async(e,r,a)=>{i(e);const c=e?o[e]:void 0,u=await n.$$(r.selector);for(const e of u){const n=await a(r,e);if(Array.isArray(n))for(const e of n.filter(e=>!t.isNil(e)&&""!==e))c?c.add(e):t.forEach(e,(t,e)=>{i(e),o[e].add(t)})}},c=(t,e)=>!!t.exclude&&t.exclude.some(t=>t.startsWith("^")?e.startsWith(t.substr(1)):e===t),u=async(t,e)=>{const n=Fr(await e.textContent());if(n&&!c(t,n))return[n]},s=async(t,e,n)=>{const r=[];for(const o of n){let n;n=o.startsWith("@")?await e.getAttribute(o.substr(1)):Fr(await e.text()),c(t,n)||r.push(n)}return 0===r.length?void 0:r},l=async(t,e)=>await s(t,e,t.audio),f=async(t,e)=>await s(t,e,t.visual),p=(t,e)=>t.parse(e);for(const t of e.plan)t.term?await a(t.term,t,u):t.audio?await a("audio",t,l):t.visual?await a("visual",t,f):t.parse&&await a(void 0,t,p);return{source:{name:e.name,url:e.url},data:t.mapValues(o,t=>Array.from(t))}}(e,n)}catch(t){return console.log("error",e.name,t),{source:{name:e.name,url:e.url},error:t}}}}function Ko(e,n={}){const r=n.sources||Bo.filter(e=>n.type?e.type===n.type||"universal"===e.type:!!t.isEmpty(n.include)||n.include.some(t=>e.name.toLowerCase()===t.toLowerCase()));return Promise.all(r.map(Ho).map(t=>t(e)))}export{Ko as fetchData,Bo as sources};
//# sourceMappingURL=bundle.modern.js.map
