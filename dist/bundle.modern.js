import t from"lodash";import{Base64 as e}from"js-base64";import r from"isomorphic-unfetch";import n from"cheerio";var o=function(t){try{return!!t()}catch(t){return!0}},i={}.toString,a=function(t){return i.call(t).slice(8,-1)},c="".split,u=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==a(t)?c.call(t,""):Object(t)}:Object,s=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},l=function(t){return u(s(t))},f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function p(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},r.exports),r.exports}var d,h=function(t){return t&&t.Math==Math&&t},v=h("object"==typeof globalThis&&globalThis)||h("object"==typeof window&&window)||h("object"==typeof self&&self)||h("object"==typeof f&&f)||Function("return this")(),g=!o(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),m=function(t){return"object"==typeof t?null!==t:"function"==typeof t},y=v.document,w=m(y)&&m(y.createElement),b=function(t){return w?y.createElement(t):{}},x=!g&&!o(function(){return 7!=Object.defineProperty(b("div"),"a",{get:function(){return 7}}).a}),S=function(t){if(!m(t))throw TypeError(String(t)+" is not an object");return t},E=function(t,e){if(!m(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!m(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!m(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!m(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")},O=Object.defineProperty,j={f:g?O:function(t,e,r){if(S(t),e=E(e,!0),S(r),x)try{return O(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},P=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},A=g?function(t,e,r){return j.f(t,e,P(1,r))}:function(t,e,r){return t[e]=r,t},T=function(t,e){try{A(v,t,e)}catch(r){v[t]=e}return e},R=v["__core-js_shared__"]||T("__core-js_shared__",{}),I=p(function(t){(t.exports=function(t,e){return R[t]||(R[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})}),C={}.hasOwnProperty,k=function(t,e){return C.call(t,e)},$=0,_=Math.random(),L=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++$+_).toString(36)},M=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())}),U=M&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,N=I("wks"),D=v.Symbol,F=U?D:D&&D.withoutSetter||L,W=function(t){return k(N,t)||(N[t]=M&&k(D,t)?D[t]:F("Symbol."+t)),N[t]},G=Math.ceil,V=Math.floor,q=function(t){return isNaN(t=+t)?0:(t>0?V:G)(t)},B=Math.min,H=function(t){return t>0?B(q(t),9007199254740991):0},K=Math.max,X=Math.min,Y=function(t){return function(e,r,n){var o,i=l(e),a=H(i.length),c=function(t,e){var r=q(t);return r<0?K(r+e,0):X(r,e)}(n,a);if(t&&r!=r){for(;a>c;)if((o=i[c++])!=o)return!0}else for(;a>c;c++)if((t||c in i)&&i[c]===r)return t||c||0;return!t&&-1}},z={includes:Y(!0),indexOf:Y(!1)},J={},Q=z.indexOf,Z=function(t,e){var r,n=l(t),o=0,i=[];for(r in n)!k(J,r)&&k(n,r)&&i.push(r);for(;e.length>o;)k(n,r=e[o++])&&(~Q(i,r)||i.push(r));return i},tt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],et=Object.keys||function(t){return Z(t,tt)},rt=g?Object.defineProperties:function(t,e){S(t);for(var r,n=et(e),o=n.length,i=0;o>i;)j.f(t,r=n[i++],e[r]);return t},nt=v,ot=function(t){return"function"==typeof t?t:void 0},it=function(t,e){return arguments.length<2?ot(nt[t])||ot(v[t]):nt[t]&&nt[t][e]||v[t]&&v[t][e]},at=it("document","documentElement"),ct=I("keys"),ut=function(t){return ct[t]||(ct[t]=L(t))},st=ut("IE_PROTO"),lt=function(){},ft=function(t){return"<script>"+t+"<\/script>"},pt=function(){try{d=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;pt=d?function(t){t.write(ft("")),t.close();var e=t.parentWindow.Object;return t=null,e}(d):((e=b("iframe")).style.display="none",at.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(ft("document.F=Object")),t.close(),t.F);for(var r=tt.length;r--;)delete pt.prototype[tt[r]];return pt()};J[st]=!0;var dt=Object.create||function(t,e){var r;return null!==t?(lt.prototype=S(t),r=new lt,lt.prototype=null,r[st]=t):r=pt(),void 0===e?r:rt(r,e)},ht=W("unscopables"),vt=Array.prototype;null==vt[ht]&&j.f(vt,ht,{configurable:!0,value:dt(null)});var gt=function(t){vt[ht][t]=!0},mt={},yt=Function.toString;"function"!=typeof R.inspectSource&&(R.inspectSource=function(t){return yt.call(t)});var wt,bt,xt,St=R.inspectSource,Et=v.WeakMap;if("function"==typeof Et&&/native code/.test(St(Et))){var Ot=new(0,v.WeakMap),jt=Ot.get,Pt=Ot.has,At=Ot.set;wt=function(t,e){return At.call(Ot,t,e),e},bt=function(t){return jt.call(Ot,t)||{}},xt=function(t){return Pt.call(Ot,t)}}else{var Tt=ut("state");J[Tt]=!0,wt=function(t,e){return A(t,Tt,e),e},bt=function(t){return k(t,Tt)?t[Tt]:{}},xt=function(t){return k(t,Tt)}}var Rt,It,Ct,kt={set:wt,get:bt,has:xt,enforce:function(t){return xt(t)?bt(t):wt(t,{})},getterFor:function(t){return function(e){var r;if(!m(e)||(r=bt(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}},$t={}.propertyIsEnumerable,_t=Object.getOwnPropertyDescriptor,Lt={f:_t&&!$t.call({1:2},1)?function(t){var e=_t(this,t);return!!e&&e.enumerable}:$t},Mt=Object.getOwnPropertyDescriptor,Ut={f:g?Mt:function(t,e){if(t=l(t),e=E(e,!0),x)try{return Mt(t,e)}catch(t){}if(k(t,e))return P(!Lt.f.call(t,e),t[e])}},Nt=p(function(t){var e=kt.get,r=kt.enforce,n=String(String).split("String");(t.exports=function(t,e,o,i){var a=!!i&&!!i.unsafe,c=!!i&&!!i.enumerable,u=!!i&&!!i.noTargetGet;"function"==typeof o&&("string"!=typeof e||k(o,"name")||A(o,"name",e),r(o).source=n.join("string"==typeof e?e:"")),t!==v?(a?!u&&t[e]&&(c=!0):delete t[e],c?t[e]=o:A(t,e,o)):c?t[e]=o:T(e,o)})(Function.prototype,"toString",function(){return"function"==typeof this&&e(this).source||St(this)})}),Dt=tt.concat("length","prototype"),Ft={f:Object.getOwnPropertyNames||function(t){return Z(t,Dt)}},Wt={f:Object.getOwnPropertySymbols},Gt=it("Reflect","ownKeys")||function(t){var e=Ft.f(S(t)),r=Wt.f;return r?e.concat(r(t)):e},Vt=function(t,e){for(var r=Gt(e),n=j.f,o=Ut.f,i=0;i<r.length;i++){var a=r[i];k(t,a)||n(t,a,o(e,a))}},qt=/#|\.prototype\./,Bt=function(t,e){var r=Kt[Ht(t)];return r==Yt||r!=Xt&&("function"==typeof e?o(e):!!e)},Ht=Bt.normalize=function(t){return String(t).replace(qt,".").toLowerCase()},Kt=Bt.data={},Xt=Bt.NATIVE="N",Yt=Bt.POLYFILL="P",zt=Bt,Jt=Ut.f,Qt=function(t,e){var r,n,o,i,a,c=t.target,u=t.global,s=t.stat;if(r=u?v:s?v[c]||T(c,{}):(v[c]||{}).prototype)for(n in e){if(i=e[n],o=t.noTargetGet?(a=Jt(r,n))&&a.value:r[n],!zt(u?n:c+(s?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Vt(i,o)}(t.sham||o&&o.sham)&&A(i,"sham",!0),Nt(r,n,i,t)}},Zt=function(t){return Object(s(t))},te=!o(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),ee=ut("IE_PROTO"),re=Object.prototype,ne=te?Object.getPrototypeOf:function(t){return t=Zt(t),k(t,ee)?t[ee]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?re:null},oe=W("iterator"),ie=!1;[].keys&&("next"in(Ct=[].keys())?(It=ne(ne(Ct)))!==Object.prototype&&(Rt=It):ie=!0),null==Rt&&(Rt={}),k(Rt,oe)||A(Rt,oe,function(){return this});var ae={IteratorPrototype:Rt,BUGGY_SAFARI_ITERATORS:ie},ce=j.f,ue=W("toStringTag"),se=function(t,e,r){t&&!k(t=r?t:t.prototype,ue)&&ce(t,ue,{configurable:!0,value:e})},le=ae.IteratorPrototype,fe=function(){return this},pe=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return S(r),function(t){if(!m(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(n),e?t.call(r,n):r.__proto__=n,r}}():void 0),de=ae.IteratorPrototype,he=ae.BUGGY_SAFARI_ITERATORS,ve=W("iterator"),ge=function(){return this},me=kt.set,ye=kt.getterFor("Array Iterator"),we=function(t,e,r,n,o,i,a){!function(t,e,r){t.prototype=dt(le,{next:P(1,function(){var t=ye(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}})}),se(t,"Array Iterator",!1),mt["Array Iterator"]=fe}(r);var c,u,s,l=function(t){if("values"===t&&h)return h;if(!he&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},f=!1,p=t.prototype,d=p[ve]||p["@@iterator"]||p.values,h=!he&&d||l("values"),v=p.entries||d;if(v&&(c=ne(v.call(new t)),de!==Object.prototype&&c.next&&(ne(c)!==de&&(pe?pe(c,de):"function"!=typeof c[ve]&&A(c,ve,ge)),se(c,"Array Iterator",!0))),d&&"values"!==d.name&&(f=!0,h=function(){return d.call(this)}),p[ve]!==h&&A(p,ve,h),mt.Array=h,void(u={values:l("values"),keys:l("keys"),entries:l("entries")}))for(s in u)(he||f||!(s in p))&&Nt(p,s,u[s]);else Qt({target:"Array",proto:!0,forced:he||f},u);return u}(Array,0,function(t,e){me(this,{type:"Array Iterator",target:l(t),index:0,kind:e})});mt.Arguments=mt.Array,gt("keys"),gt("values"),gt("entries");var be=v.Promise,xe=W("species"),Se=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},Ee=W("iterator"),Oe=Array.prototype,je=function(t,e,r){if(Se(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,o){return t.call(e,r,n,o)}}return function(){return t.apply(e,arguments)}},Pe={};Pe[W("toStringTag")]="z";var Ae="[object z]"===String(Pe),Te=W("toStringTag"),Re="Arguments"==a(function(){return arguments}()),Ie=Ae?a:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Te))?r:Re?a(e):"Object"==(n=a(e))&&"function"==typeof e.callee?"Arguments":n},Ce=W("iterator"),ke=function(t,e,r,n){try{return n?e(S(r)[0],r[1]):e(r)}catch(e){var o=t.return;throw void 0!==o&&S(o.call(t)),e}},$e=p(function(t){var e=function(t,e){this.stopped=t,this.result=e};(t.exports=function(t,r,n,o,i){var a,c,u,s,l,f,p,d,h=je(r,n,o?2:1);if(i)a=t;else{if("function"!=typeof(c=function(t){if(null!=t)return t[Ce]||t["@@iterator"]||mt[Ie(t)]}(t)))throw TypeError("Target is not iterable");if(void 0!==(d=c)&&(mt.Array===d||Oe[Ee]===d)){for(u=0,s=H(t.length);s>u;u++)if((l=o?h(S(p=t[u])[0],p[1]):h(t[u]))&&l instanceof e)return l;return new e(!1)}a=c.call(t)}for(f=a.next;!(p=f.call(a)).done;)if("object"==typeof(l=ke(a,h,p.value,o))&&l&&l instanceof e)return l;return new e(!1)}).stop=function(t){return new e(!0,t)}}),_e=W("iterator"),Le=!1;try{var Me=0,Ue={next:function(){return{done:!!Me++}},return:function(){Le=!0}};Ue[_e]=function(){return this},Array.from(Ue,function(){throw 2})}catch(t){}var Ne,De,Fe,We=W("species"),Ge=function(t,e){var r,n=S(t).constructor;return void 0===n||null==(r=S(n)[We])?e:Se(r)},Ve=it("navigator","userAgent")||"",qe=/(iphone|ipod|ipad).*applewebkit/i.test(Ve),Be=v.location,He=v.setImmediate,Ke=v.clearImmediate,Xe=v.process,Ye=v.MessageChannel,ze=v.Dispatch,Je=0,Qe={},Ze=function(t){if(Qe.hasOwnProperty(t)){var e=Qe[t];delete Qe[t],e()}},tr=function(t){return function(){Ze(t)}},er=function(t){Ze(t.data)},rr=function(t){v.postMessage(t+"",Be.protocol+"//"+Be.host)};He&&Ke||(He=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return Qe[++Je]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},Ne(Je),Je},Ke=function(t){delete Qe[t]},"process"==a(Xe)?Ne=function(t){Xe.nextTick(tr(t))}:ze&&ze.now?Ne=function(t){ze.now(tr(t))}:Ye&&!qe?(Fe=(De=new Ye).port2,De.port1.onmessage=er,Ne=je(Fe.postMessage,Fe,1)):!v.addEventListener||"function"!=typeof postMessage||v.importScripts||o(rr)||"file:"===Be.protocol?Ne="onreadystatechange"in b("script")?function(t){at.appendChild(b("script")).onreadystatechange=function(){at.removeChild(this),Ze(t)}}:function(t){setTimeout(tr(t),0)}:(Ne=rr,v.addEventListener("message",er,!1)));var nr,or,ir,ar,cr,ur,sr,lr,fr={set:He,clear:Ke},pr=Ut.f,dr=fr.set,hr=v.MutationObserver||v.WebKitMutationObserver,vr=v.process,gr=v.Promise,mr="process"==a(vr),yr=pr(v,"queueMicrotask"),wr=yr&&yr.value;wr||(nr=function(){var t,e;for(mr&&(t=vr.domain)&&t.exit();or;){e=or.fn,or=or.next;try{e()}catch(t){throw or?ar():ir=void 0,t}}ir=void 0,t&&t.enter()},mr?ar=function(){vr.nextTick(nr)}:hr&&!qe?(cr=!0,ur=document.createTextNode(""),new hr(nr).observe(ur,{characterData:!0}),ar=function(){ur.data=cr=!cr}):gr&&gr.resolve?(sr=gr.resolve(void 0),lr=sr.then,ar=function(){lr.call(sr,nr)}):ar=function(){dr.call(v,nr)});var br,xr,Sr=wr||function(t){var e={fn:t,next:void 0};ir&&(ir.next=e),or||(or=e,ar()),ir=e},Er=function(t){var e,r;this.promise=new t(function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n}),this.resolve=Se(e),this.reject=Se(r)},Or={f:function(t){return new Er(t)}},jr=function(t,e){if(S(t),m(e)&&e.constructor===t)return e;var r=Or.f(t);return(0,r.resolve)(e),r.promise},Pr=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Ar=v.process,Tr=Ar&&Ar.versions,Rr=Tr&&Tr.v8;Rr?xr=(br=Rr.split("."))[0]+br[1]:Ve&&(!(br=Ve.match(/Edge\/(\d+)/))||br[1]>=74)&&(br=Ve.match(/Chrome\/(\d+)/))&&(xr=br[1]);var Ir,Cr,kr,$r,_r,Lr=xr&&+xr,Mr=fr.set,Ur=W("species"),Nr=kt.get,Dr=kt.set,Fr=kt.getterFor("Promise"),Wr=be,Gr=v.TypeError,Vr=v.document,qr=v.process,Br=it("fetch"),Hr=Or.f,Kr=Hr,Xr="process"==a(qr),Yr=!!(Vr&&Vr.createEvent&&v.dispatchEvent),zr=zt("Promise",function(){if(St(Wr)===String(Wr)){if(66===Lr)return!0;if(!Xr&&"function"!=typeof PromiseRejectionEvent)return!0}if(Lr>=51&&/native code/.test(Wr))return!1;var t=Wr.resolve(1),e=function(t){t(function(){},function(){})};return(t.constructor={})[Ur]=e,!(t.then(function(){})instanceof e)}),Jr=zr||!function(t,e){if(!Le)return!1;var r=!1;try{var n={};n[_e]=function(){return{next:function(){return{done:r=!0}}}},Wr.all(n).catch(function(){})}catch(t){}return r}(),Qr=function(t){var e;return!(!m(t)||"function"!=typeof(e=t.then))&&e},Zr=function(t,e,r){if(!e.notified){e.notified=!0;var n=e.reactions;Sr(function(){for(var o=e.value,i=1==e.state,a=0;n.length>a;){var c,u,s,l=n[a++],f=i?l.ok:l.fail,p=l.resolve,d=l.reject,h=l.domain;try{f?(i||(2===e.rejection&&nn(t,e),e.rejection=1),!0===f?c=o:(h&&h.enter(),c=f(o),h&&(h.exit(),s=!0)),c===l.promise?d(Gr("Promise-chain cycle")):(u=Qr(c))?u.call(c,p,d):p(c)):d(o)}catch(t){h&&!s&&h.exit(),d(t)}}e.reactions=[],e.notified=!1,r&&!e.rejection&&en(t,e)})}},tn=function(t,e,r){var n,o;Yr?((n=Vr.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),v.dispatchEvent(n)):n={promise:e,reason:r},(o=v["on"+t])?o(n):"unhandledrejection"===t&&function(t,e){var r=v.console;r&&r.error&&(1===arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)},en=function(t,e){Mr.call(v,function(){var r,n=e.value;if(rn(e)&&(r=Pr(function(){Xr?qr.emit("unhandledRejection",n,t):tn("unhandledrejection",t,n)}),e.rejection=Xr||rn(e)?2:1,r.error))throw r.value})},rn=function(t){return 1!==t.rejection&&!t.parent},nn=function(t,e){Mr.call(v,function(){Xr?qr.emit("rejectionHandled",t):tn("rejectionhandled",t,e.value)})},on=function(t,e,r,n){return function(o){t(e,r,o,n)}},an=function(t,e,r,n){e.done||(e.done=!0,n&&(e=n),e.value=r,e.state=2,Zr(t,e,!0))},cn=function(t,e,r,n){if(!e.done){e.done=!0,n&&(e=n);try{if(t===r)throw Gr("Promise can't be resolved itself");var o=Qr(r);o?Sr(function(){var n={done:!1};try{o.call(r,on(cn,t,n,e),on(an,t,n,e))}catch(r){an(t,n,r,e)}}):(e.value=r,e.state=1,Zr(t,e,!1))}catch(r){an(t,{done:!1},r,e)}}};zr&&(Wr=function(t){!function(t,e,r){if(!(t instanceof Wr))throw TypeError("Incorrect Promise invocation")}(this),Se(t),Ir.call(this);var e=Nr(this);try{t(on(cn,this,e),on(an,this,e))}catch(t){an(this,e,t)}},(Ir=function(t){Dr(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(t,e,r){for(var n in e)Nt(t,n,e[n],void 0);return t}(Wr.prototype,{then:function(t,e){var r=Fr(this),n=Hr(Ge(this,Wr));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=Xr?qr.domain:void 0,r.parent=!0,r.reactions.push(n),0!=r.state&&Zr(this,r,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),Cr=function(){var t=new Ir,e=Nr(t);this.promise=t,this.resolve=on(cn,t,e),this.reject=on(an,t,e)},Or.f=Hr=function(t){return t===Wr||t===kr?new Cr(t):Kr(t)},"function"==typeof be&&($r=be.prototype.then,Nt(be.prototype,"then",function(t,e){var r=this;return new Wr(function(t,e){$r.call(r,t,e)}).then(t,e)},{unsafe:!0}),"function"==typeof Br&&Qt({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return jr(Wr,Br.apply(v,arguments))}}))),Qt({global:!0,wrap:!0,forced:zr},{Promise:Wr}),se(Wr,"Promise",!1),_r=it("Promise"),g&&_r&&!_r[xe]&&(0,j.f)(_r,xe,{configurable:!0,get:function(){return this}}),kr=it("Promise"),Qt({target:"Promise",stat:!0,forced:zr},{reject:function(t){var e=Hr(this);return e.reject.call(void 0,t),e.promise}}),Qt({target:"Promise",stat:!0,forced:zr},{resolve:function(t){return jr(this,t)}}),Qt({target:"Promise",stat:!0,forced:Jr},{all:function(t){var e=this,r=Hr(e),n=r.resolve,o=r.reject,i=Pr(function(){var r=Se(e.resolve),i=[],a=0,c=1;$e(t,function(t){var u=a++,s=!1;i.push(void 0),c++,r.call(e,t).then(function(t){s||(s=!0,i[u]=t,--c||n(i))},o)}),--c||n(i)});return i.error&&o(i.value),r.promise},race:function(t){var e=this,r=Hr(e),n=r.reject,o=Pr(function(){var o=Se(e.resolve);$e(t,function(t){o.call(e,t).then(r.resolve,n)})});return o.error&&n(o.value),r.promise}});var un,sn=W("match"),ln=function(t){var e;return m(t)&&(void 0!==(e=t[sn])?!!e:"RegExp"==a(t))},fn=function(t){if(ln(t))throw TypeError("The method doesn't accept regular expressions");return t},pn=W("match"),dn=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[pn]=!1,"/./"[t](e)}catch(t){}}return!1},hn=Ut.f,vn="".startsWith,gn=Math.min,mn=dn("startsWith"),yn=!(mn||(un=hn(String.prototype,"startsWith"),!un||un.writable));Qt({target:"String",proto:!0,forced:!yn&&!mn},{startsWith:function(t){var e=String(s(this));fn(t);var r=H(gn(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return vn?vn.call(e,n,r):e.slice(r,r+n.length)===n}});var wn={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},bn=W("iterator"),xn=W("toStringTag"),Sn=we.values;for(var En in wn){var On=v[En],jn=On&&On.prototype;if(jn){if(jn[bn]!==Sn)try{A(jn,bn,Sn)}catch(t){jn[bn]=Sn}if(jn[xn]||A(jn,xn,En),wn[En])for(var Pn in we)if(jn[Pn]!==we[Pn])try{A(jn,Pn,we[Pn])}catch(t){jn[Pn]=we[Pn]}}}var An=function(){var t=S(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e},Tn=RegExp.prototype,Rn=Tn.toString;(o(function(){return"/a/b"!=Rn.call({source:"a",flags:"b"})})||"toString"!=Rn.name)&&Nt(RegExp.prototype,"toString",function(){var t=S(this),e=String(t.source),r=t.flags;return"/"+e+"/"+String(void 0===r&&t instanceof RegExp&&!("flags"in Tn)?An.call(t):r)},{unsafe:!0});var In="\t\n\v\f\r                　\u2028\u2029\ufeff",Cn="["+In+"]",kn=RegExp("^"+Cn+Cn+"*"),$n=RegExp(Cn+Cn+"*$"),_n=function(t){return function(e){var r=String(s(e));return 1&t&&(r=r.replace(kn,"")),2&t&&(r=r.replace($n,"")),r}},Ln={start:_n(1),end:_n(2),trim:_n(3)},Mn=function(t){return o(function(){return!!In[t]()||"​᠎"!="​᠎"[t]()||In[t].name!==t})},Un=Ln.trim;function Nn(e){return t.trim(null==e?void 0:e.trim(),"​")}Qt({target:"String",proto:!0,forced:Mn("trim")},{trim:function(){return Un(this)}});const Dn=!("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))&&"undefined"!=typeof window;function Fn(t,e){return RegExp(t,e)}var Wn,Gn,Vn={UNSUPPORTED_Y:o(function(){var t=Fn("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),BROKEN_CARET:o(function(){var t=Fn("^r","gy");return t.lastIndex=2,null!=t.exec("str")})},qn=RegExp.prototype.exec,Bn=String.prototype.replace,Hn=qn,Kn=(Gn=/b*/g,qn.call(Wn=/a/,"a"),qn.call(Gn,"a"),0!==Wn.lastIndex||0!==Gn.lastIndex),Xn=Vn.UNSUPPORTED_Y||Vn.BROKEN_CARET,Yn=void 0!==/()??/.exec("")[1];(Kn||Yn||Xn)&&(Hn=function(t){var e,r,n,o,i=this,a=Xn&&i.sticky,c=An.call(i),u=i.source,s=0,l=t;return a&&(-1===(c=c.replace("y","")).indexOf("g")&&(c+="g"),l=String(t).slice(i.lastIndex),i.lastIndex>0&&(!i.multiline||i.multiline&&"\n"!==t[i.lastIndex-1])&&(u="(?: "+u+")",l=" "+l,s++),r=new RegExp("^(?:"+u+")",c)),Yn&&(r=new RegExp("^"+u+"$(?!\\s)",c)),Kn&&(e=i.lastIndex),n=qn.call(a?r:i,l),a?n?(n.input=n.input.slice(s),n[0]=n[0].slice(s),n.index=i.lastIndex,i.lastIndex+=n[0].length):i.lastIndex=0:Kn&&n&&(i.lastIndex=i.global?n.index+n[0].length:e),Yn&&n&&n.length>1&&Bn.call(n[0],r,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(n[o]=void 0)}),n});var zn=Hn;Qt({target:"RegExp",proto:!0,forced:/./.exec!==zn},{exec:zn});var Jn=W("species"),Qn=!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),Zn="$0"==="a".replace(/./,"$0"),to=W("replace"),eo=!!/./[to]&&""===/./[to]("a","$0"),ro=!o(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}),no=function(t,e,r,n){var i=W(t),a=!o(function(){var e={};return e[i]=function(){return 7},7!=""[t](e)}),c=a&&!o(function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[Jn]=function(){return r},r.flags="",r[i]=/./[i]),r.exec=function(){return e=!0,null},r[i](""),!e});if(!a||!c||"replace"===t&&(!Qn||!Zn||eo)||"split"===t&&!ro){var u=/./[i],s=r(i,""[t],function(t,e,r,n,o){return e.exec===zn?a&&!o?{done:!0,value:u.call(e,r,n)}:{done:!0,value:t.call(r,e,n)}:{done:!1}},{REPLACE_KEEPS_$0:Zn,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:eo}),l=s[1];Nt(String.prototype,t,s[0]),Nt(RegExp.prototype,i,2==e?function(t,e){return l.call(t,this,e)}:function(t){return l.call(t,this)})}n&&A(RegExp.prototype[i],"sham",!0)},oo=function(t){return function(e,r){var n,o,i=String(s(e)),a=q(r),c=i.length;return a<0||a>=c?t?"":void 0:(n=i.charCodeAt(a))<55296||n>56319||a+1===c||(o=i.charCodeAt(a+1))<56320||o>57343?t?i.charAt(a):n:t?i.slice(a,a+2):o-56320+(n-55296<<10)+65536}},io=(oo(!1),oo(!0)),ao=function(t,e,r){return e+(r?io(t,e).length:1)},co=function(t,e){var r=t.exec;if("function"==typeof r){var n=r.call(t,e);if("object"!=typeof n)throw TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==a(t))throw TypeError("RegExp#exec called on incompatible receiver");return zn.call(t,e)},uo=Math.max,so=Math.min,lo=Math.floor,fo=/\$([$&'`]|\d\d?|<[^>]*>)/g,po=/\$([$&'`]|\d\d?)/g;no("replace",2,function(t,e,r,n){var o=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,i=n.REPLACE_KEEPS_$0,a=o?"$":"$0";return[function(r,n){var o=s(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,o,n):e.call(String(o),r,n)},function(t,n){if(!o&&i||"string"==typeof n&&-1===n.indexOf(a)){var u=r(e,t,this,n);if(u.done)return u.value}var s=S(t),l=String(this),f="function"==typeof n;f||(n=String(n));var p=s.global;if(p){var d=s.unicode;s.lastIndex=0}for(var h=[];;){var v=co(s,l);if(null===v)break;if(h.push(v),!p)break;""===String(v[0])&&(s.lastIndex=ao(l,H(s.lastIndex),d))}for(var g,m="",y=0,w=0;w<h.length;w++){v=h[w];for(var b=String(v[0]),x=uo(so(q(v.index),l.length),0),E=[],O=1;O<v.length;O++)E.push(void 0===(g=v[O])?g:String(g));var j=v.groups;if(f){var P=[b].concat(E,x,l);void 0!==j&&P.push(j);var A=String(n.apply(void 0,P))}else A=c(b,l,x,E,j,n);x>=y&&(m+=l.slice(y,x)+A,y=x+b.length)}return m+l.slice(y)}];function c(t,r,n,o,i,a){var c=n+t.length,u=o.length,s=po;return void 0!==i&&(i=Zt(i),s=fo),e.call(a,s,function(e,a){var s;switch(a.charAt(0)){case"$":return"$";case"&":return t;case"`":return r.slice(0,n);case"'":return r.slice(c);case"<":s=i[a.slice(1,-1)];break;default:var l=+a;if(0===l)return e;if(l>u){var f=lo(l/10);return 0===f?e:f<=u?void 0===o[f-1]?a.charAt(1):o[f-1]+a.charAt(1):e}s=o[l-1]}return void 0===s?"":s})}});var ho,vo=Object.defineProperty,go={},mo=function(t){throw t},yo=z.indexOf,wo=[].indexOf,bo=!!wo&&1/[1].indexOf(1,-0)<0,xo=!!(ho=[].indexOf)&&o(function(){ho.call(null,function(){throw 1},1)}),So=function(t,e){if(k(go,"indexOf"))return go.indexOf;e||(e={});var r=[].indexOf,n=!!k(e,"ACCESSORS")&&e.ACCESSORS,i=k(e,0)?e[0]:mo,a=k(e,1)?e[1]:void 0;return go.indexOf=!!r&&!o(function(){if(n&&!g)return!0;var t={length:-1};n?vo(t,1,{enumerable:!0,get:mo}):t[1]=1,r.call(t,i,a)})}(0,{ACCESSORS:!0,1:0});Qt({target:"Array",proto:!0,forced:bo||!xo||!So},{indexOf:function(t){return bo?wo.apply(this,arguments)||0:yo(this,t,arguments.length>1?arguments[1]:void 0)}});var Eo=Object.assign,Oo=Object.defineProperty,jo=!Eo||o(function(){if(g&&1!==Eo({b:1},Eo(Oo({},"a",{enumerable:!0,get:function(){Oo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=Eo({},t)[r]||"abcdefghijklmnopqrst"!=et(Eo({},e)).join("")})?function(t,e){for(var r=Zt(t),n=arguments.length,o=1,i=Wt.f,a=Lt.f;n>o;)for(var c,s=u(arguments[o++]),l=i?et(s).concat(i(s)):et(s),f=l.length,p=0;f>p;)c=l[p++],g&&!a.call(s,c)||(r[c]=s[c]);return r}:Eo;Qt({target:"Object",stat:!0,forced:Object.assign!==jo},{assign:jo});var Po=Ut.f,Ao="".endsWith,To=Math.min,Ro=dn("endsWith"),Io=!Ro&&!!function(){var t=Po(String.prototype,"endsWith");return t&&!t.writable}();Qt({target:"String",proto:!0,forced:!Io&&!Ro},{endsWith:function(t){var e=String(s(this));fn(t);var r=arguments.length>1?arguments[1]:void 0,n=H(e.length),o=void 0===r?n:To(H(r),n),i=String(t);return Ao?Ao.call(e,i,o):e.slice(o-i.length,o)===i}});var Co=[].push,ko=Math.min,$o=!o(function(){return!RegExp(4294967295,"y")});no("split",2,function(t,e,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var n=String(s(this)),o=void 0===r?4294967295:r>>>0;if(0===o)return[];if(void 0===t)return[n];if(!ln(t))return e.call(n,t,o);for(var i,a,c,u=[],l=0,f=new RegExp(t.source,(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":"")+"g");(i=zn.call(f,n))&&!((a=f.lastIndex)>l&&(u.push(n.slice(l,i.index)),i.length>1&&i.index<n.length&&Co.apply(u,i.slice(1)),c=i[0].length,l=a,u.length>=o));)f.lastIndex===i.index&&f.lastIndex++;return l===n.length?!c&&f.test("")||u.push(""):u.push(n.slice(l)),u.length>o?u.slice(0,o):u}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:e.call(this,t,r)}:e,[function(e,r){var o=s(this),i=null==e?void 0:e[t];return void 0!==i?i.call(e,o,r):n.call(String(o),e,r)},function(t,o){var i=r(n,t,this,o,n!==e);if(i.done)return i.value;var a=S(t),c=String(this),u=Ge(a,RegExp),s=a.unicode,l=new u($o?a:"^(?:"+a.source+")",(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+($o?"y":"g")),f=void 0===o?4294967295:o>>>0;if(0===f)return[];if(0===c.length)return null===co(l,c)?[c]:[];for(var p=0,d=0,h=[];d<c.length;){l.lastIndex=$o?d:0;var v,g=co(l,$o?c:c.slice(d));if(null===g||(v=ko(H(l.lastIndex+($o?0:d)),c.length))===p)d=ao(c,d,s);else{if(h.push(c.slice(p,d)),h.length===f)return h;for(var m=1;m<=g.length-1;m++)if(h.push(g[m]),h.length===f)return h;d=p=v}}return h.push(c.slice(p)),h}]},!$o);var _o=Ln.end,Lo=Mn("trimEnd"),Mo=Lo?function(){return _o(this)}:"".trimEnd;Qt({target:"String",proto:!0,forced:Lo},{trimEnd:Mo,trimRight:Mo});var Uo=Ln.start,No=Mn("trimStart"),Do=No?function(){return Uo(this)}:"".trimStart;Qt({target:"String",proto:!0,forced:No},{trimStart:Do,trimLeft:Do});const Fo=encodeURIComponent;function Wo(t){return t&&t.startsWith("'")?t.substr(1,t.length-2):t}const Go={type:"audio",name:"forvo",url:"https://forvo.com",makeUrl:({text:t,lang:e})=>`https://ru.forvo.com/word/${Fo(t)}/#${e}`,plan:[{selector:"article.pronunciations ul.show-all-pronunciations li",parse:async r=>{const n=(await r.$$("span.play"))[0];if(!n)return;const o=function(t){if(!t)return;const e=t.indexOf("("),r=t.indexOf(")");return{name:t.substr(0,e),args:t.substr(e+1,r-e-1).split(",").map(Wo)}}(await n.getAttribute("onclick"));if(!o||"Play"!==o.name)return;const i="https://audio00.forvo.com/audios/mp3/"+e.decode(o.args[4]);if(!i.endsWith(".mp3"))return;const a={url:i},c=(await r.$$("span.ofLink"))[0];if(c){const t=await c.getAttribute("data-p2");t&&(a.author=t)}const u=(await r.$$("span.from"))[0];if(u){const e=function(e){if(!e)return;const r=(e=t.trimEnd(t.trimStart(e,"("),")")).split(",");if(t.isEmpty(r))return;const n={gender:(o=r[0],"женщина"===(o=Nn(o))?"f":"мужчина"===o?"m":o)};var o;return 2===r.length&&(n.country=function(t){return Nn(t)}(r[1])),n}(await u.textContent());e&&Object.assign(a,e)}return[{audio:a}]}}]},Vo={type:"audio",name:"howjsay",url:"https://howjsay.com",getData:async({text:t})=>({audio:[{url:`https://howjsay.com/mp3/${encodeURIComponent(t)}.mp3`}]})},qo={type:"universal",name:"merriam-webster",url:"https://www.merriam-webster.com",makeUrl:({text:t})=>"/dictionary/"+encodeURIComponent(t),plan:[{selector:"span.prs a.play-pron",audio:async t=>`https://media.merriam-webster.com/audio/prons/${(await t.getAttribute("data-lang")).replace("_","/")}/mp3/${await t.getAttribute("data-dir")}/${await t.getAttribute("data-file")}.mp3`},{selector:"span.prs span.pr",term:"transcription"},{selector:"div.vg .dt",term:"definition",lstrip:":"},{selector:".ex-sent.t",term:"in"},{selector:".ure",term:"related"},{selector:"span.fl",term:"tag"}]},Bo="div.page div.dictionary div.pos-header",Ho="div.page div.dictionary div.pos-body",Ko={type:"universal",name:"cambridge",url:"https://dictionary.cambridge.org",makeUrl:({text:t})=>"/dictionary/english/"+t.replace(" ","-"),plan:[{selector:Bo+" span.dpron-i amp-audio source",audio:["@src"]},{selector:Bo+" span.dpron-i span.ipa",term:"transcription"},{selector:Bo+" .posgram .pos",term:"tag"},{selector:Bo+" .posgram .gram .gc",term:"tag",map:t=>({C:"countable",U:"uncountable",S:"singular"}[t]||void 0)},{selector:Ho+" div.def-block div.def",term:"definition"},{selector:Ho+" div.def-block amp-img",visual:["@src"]},{selector:Ho+" div.def-block span.eg",term:"in"},{selector:"div.page div.dataset span.deg",term:"in"},{selector:"div.page div.dataset div.cpegs div.lbb a.hdib",term:"collocation"}]};class Xo{constructor(t,e){this.$=t,this.elem=e}async $$(t){const e=this.elem.find(t),r=[];return e.each((t,e)=>{r.push(new Xo(this.$,this.$(e)))}),r}async getAttribute(t){return this.elem.attr(t)}async textContent(){return this.elem.text()}}class Yo{constructor(t){this.$=n.load(t)}$$(t){const e=this.$(t),r=[];return e.each((t,e)=>{r.push(new Xo(this.$,this.$(e)))}),Promise.resolve(r)}close(){return Promise.resolve(void 0)}}async function zo(t){Dn&&(t="https://api.allorigins.win/raw?url="+encodeURIComponent(t));const e=await r(t,{headers:{"User-Agent":"lingua-bot",Accept:"text/html,application/xhtml+xml"}});if(!e.ok)throw new Error(e.statusText);const n=await e.text();return new Yo(n)}class Jo{constructor(t,e){this.page=t,this.elem=e}async $$(t){return(await this.elem.$$(t)).map(t=>new Jo(this.page,t))}getAttribute(t){return this.elem.getAttribute(t)}textContent(){return this.elem.textContent()}}class Qo{constructor(t,e){this.browser=t,this.page=e}async $$(t){try{await this.page.waitForSelector(t,{timeout:5e3})}catch(t){}return(await this.page.$$(t)).map(t=>new Jo(this.page,t))}async close(){await this.page.close(),await this.browser.close()}}const Zo=[{type:"visual",name:"unsplash",url:"https://unsplash.com",makeUrl:({text:t})=>"/s/photos/"+t.replace(" ","-"),plan:[{selector:'div[data-test="search-photos-route"] figure img',exclude:["^https://images.unsplash.com/profile-"],visual:["@src"]}]},{type:"universal",engine:"playwright",name:"wordnik",url:"https://www.wordnik.com",makeUrl:({text:t})=>"/words/"+t,plan:[{selector:".flickr-module .thumbs img",visual:["@src"]}]},{type:"universal",name:"macmillan",url:"https://www.macmillandictionary.com",makeUrl:({text:t})=>"/dictionary/british/"+t,plan:[{selector:".audio_play_button",audio:["@data-src-mp3","@data-src-ogg"]},{selector:".PRON",term:"transcription"},{selector:".PART-OF-SPEECH",term:"tag"},{selector:".SYNTAX-CODING",term:"tag"},{selector:".DEFINITION",term:"definition"},{selector:".EXAMPLES",term:"in"},{selector:".PHR-XREF",term:"in"},{selector:".synonyms .theslink",exclude:["..."],term:"synonym"}]},qo,Ko,Go,Vo];function ti(e){return async({text:r,lang:n})=>{const o={text:r,lang:n||"en"};if(e.getData)try{const t=await e.getData(o);return{source:{name:e.name,url:e.url},data:t}}catch(t){return console.log("error",e.name,t),{source:{name:e.name,url:e.url},error:t}}let i=e.makeUrl(o);i.startsWith("/")&&(i=e.url+i);try{const r=await function(t,e){return"playwright"===t?async function(t){if(Dn)return await zo(t);const{chromium:e}=require("playwright"),r=await e.launch(),n=await r.newPage();return await n.goto(t),new Qo(r,n)}(e):zo(e)}(e.engine,i);return async function(e,r,n){const o={},i=t=>{t&&!o[t]&&(o[t]=new Set)},a=async(e,n,a)=>{i(e);const c=e?o[e]:void 0,u=await r.$$(n.selector);for(const e of u){const r=await a(n,e);if(Array.isArray(r))for(const e of r.filter(e=>!t.isNil(e)&&""!==e))c?c.add(e):t.forEach(e,(t,e)=>{i(e),o[e].add(t)})}},c=(t,e)=>!!t.exclude&&t.exclude.some(t=>t.startsWith("^")?e.startsWith(t.substr(1)):e===t),u=async(t,e)=>{let r=Nn(await e.textContent());if(r&&!c(t,r)&&(t.lstrip&&r.startsWith(t.lstrip)&&(r=Nn(r.substr(t.lstrip.length))),r&&(t.map&&(r=t.map(r)),r)))return[r]},s=async(e,r,n)=>{const o=[];if(t.isArray(n))for(const i of n){let n;n=t.isString(i)?i.startsWith("@")?await r.getAttribute(i.substr(1)):Nn(await r.text()):await i(r),c(e,n)||o.push(n)}else{const t=await n(r);c(e,t)||o.push(t)}return 0===o.length?void 0:o},l=async(t,e)=>await s(t,e,t.audio),f=async(t,e)=>await s(t,e,t.visual),p=(t,e)=>t.parse(e);for(const t of e.plan)t.term?await a(t.term,t,u):t.audio?await a("audio",t,l):t.visual?await a("visual",t,f):t.parse&&await a(void 0,t,p);return{source:{name:e.name,url:e.url},data:t.mapValues(o,t=>Array.from(t))}}(e,r)}catch(t){return console.log("error",e.name,t),{source:{name:e.name,url:e.url},error:t}}}}function ei(e,r={}){const n=r.sources||Zo.filter(e=>!(r.type&&e.type!==r.type&&"universal"!==e.type||!t.isEmpty(r.include)&&!r.include.some(t=>e.name.toLowerCase()===t.toLowerCase())||!t.isEmpty(r.exclude)&&r.exclude.some(t=>e.name.toLowerCase()===t.toLowerCase())));return Promise.all(n.map(ti).map(t=>t(e)))}export{ei as fetchData,Zo as sources};
//# sourceMappingURL=bundle.modern.js.map
