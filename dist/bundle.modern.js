import t from"lodash";import{Base64 as e}from"js-base64";import n from"isomorphic-unfetch";import r from"cheerio";var o=function(t){try{return!!t()}catch(t){return!0}},i={}.toString,a=function(t){return i.call(t).slice(8,-1)},c="".split,u=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==a(t)?c.call(t,""):Object(t)}:Object,s=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},l=function(t){return u(s(t))},f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function p(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},n.exports),n.exports}var h,d=function(t){return t&&t.Math==Math&&t},v=d("object"==typeof globalThis&&globalThis)||d("object"==typeof window&&window)||d("object"==typeof self&&self)||d("object"==typeof f&&f)||Function("return this")(),g=!o(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),y=function(t){return"object"==typeof t?null!==t:"function"==typeof t},m=v.document,w=y(m)&&y(m.createElement),b=function(t){return w?m.createElement(t):{}},x=!g&&!o(function(){return 7!=Object.defineProperty(b("div"),"a",{get:function(){return 7}}).a}),S=function(t){if(!y(t))throw TypeError(String(t)+" is not an object");return t},E=function(t,e){if(!y(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!y(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!y(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!y(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},O=Object.defineProperty,j={f:g?O:function(t,e,n){if(S(t),e=E(e,!0),S(n),x)try{return O(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},P=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},T=g?function(t,e,n){return j.f(t,e,P(1,n))}:function(t,e,n){return t[e]=n,t},A=function(t,e){try{T(v,t,e)}catch(n){v[t]=e}return e},R=v["__core-js_shared__"]||A("__core-js_shared__",{}),I=p(function(t){(t.exports=function(t,e){return R[t]||(R[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})}),C={}.hasOwnProperty,_=function(t,e){return C.call(t,e)},$=0,k=Math.random(),L=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++$+k).toString(36)},M=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())}),N=M&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,U=I("wks"),D=v.Symbol,F=N?D:D&&D.withoutSetter||L,W=function(t){return _(U,t)||(U[t]=M&&_(D,t)?D[t]:F("Symbol."+t)),U[t]},G=Math.ceil,V=Math.floor,q=function(t){return isNaN(t=+t)?0:(t>0?V:G)(t)},B=Math.min,H=function(t){return t>0?B(q(t),9007199254740991):0},K=Math.max,X=Math.min,Y=function(t){return function(e,n,r){var o,i=l(e),a=H(i.length),c=function(t,e){var n=q(t);return n<0?K(n+e,0):X(n,e)}(r,a);if(t&&n!=n){for(;a>c;)if((o=i[c++])!=o)return!0}else for(;a>c;c++)if((t||c in i)&&i[c]===n)return t||c||0;return!t&&-1}},z={includes:Y(!0),indexOf:Y(!1)},J={},Q=z.indexOf,Z=function(t,e){var n,r=l(t),o=0,i=[];for(n in r)!_(J,n)&&_(r,n)&&i.push(n);for(;e.length>o;)_(r,n=e[o++])&&(~Q(i,n)||i.push(n));return i},tt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],et=Object.keys||function(t){return Z(t,tt)},nt=g?Object.defineProperties:function(t,e){S(t);for(var n,r=et(e),o=r.length,i=0;o>i;)j.f(t,n=r[i++],e[n]);return t},rt=v,ot=function(t){return"function"==typeof t?t:void 0},it=function(t,e){return arguments.length<2?ot(rt[t])||ot(v[t]):rt[t]&&rt[t][e]||v[t]&&v[t][e]},at=it("document","documentElement"),ct=I("keys"),ut=function(t){return ct[t]||(ct[t]=L(t))},st=ut("IE_PROTO"),lt=function(){},ft=function(t){return"<script>"+t+"<\/script>"},pt=function(){try{h=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;pt=h?function(t){t.write(ft("")),t.close();var e=t.parentWindow.Object;return t=null,e}(h):((e=b("iframe")).style.display="none",at.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(ft("document.F=Object")),t.close(),t.F);for(var n=tt.length;n--;)delete pt.prototype[tt[n]];return pt()};J[st]=!0;var ht=Object.create||function(t,e){var n;return null!==t?(lt.prototype=S(t),n=new lt,lt.prototype=null,n[st]=t):n=pt(),void 0===e?n:nt(n,e)},dt=W("unscopables"),vt=Array.prototype;null==vt[dt]&&j.f(vt,dt,{configurable:!0,value:ht(null)});var gt=function(t){vt[dt][t]=!0},yt={},mt=Function.toString;"function"!=typeof R.inspectSource&&(R.inspectSource=function(t){return mt.call(t)});var wt,bt,xt,St=R.inspectSource,Et=v.WeakMap;if("function"==typeof Et&&/native code/.test(St(Et))){var Ot=new(0,v.WeakMap),jt=Ot.get,Pt=Ot.has,Tt=Ot.set;wt=function(t,e){return Tt.call(Ot,t,e),e},bt=function(t){return jt.call(Ot,t)||{}},xt=function(t){return Pt.call(Ot,t)}}else{var At=ut("state");J[At]=!0,wt=function(t,e){return T(t,At,e),e},bt=function(t){return _(t,At)?t[At]:{}},xt=function(t){return _(t,At)}}var Rt,It,Ct,_t={set:wt,get:bt,has:xt,enforce:function(t){return xt(t)?bt(t):wt(t,{})},getterFor:function(t){return function(e){var n;if(!y(e)||(n=bt(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}},$t={}.propertyIsEnumerable,kt=Object.getOwnPropertyDescriptor,Lt={f:kt&&!$t.call({1:2},1)?function(t){var e=kt(this,t);return!!e&&e.enumerable}:$t},Mt=Object.getOwnPropertyDescriptor,Nt={f:g?Mt:function(t,e){if(t=l(t),e=E(e,!0),x)try{return Mt(t,e)}catch(t){}if(_(t,e))return P(!Lt.f.call(t,e),t[e])}},Ut=p(function(t){var e=_t.get,n=_t.enforce,r=String(String).split("String");(t.exports=function(t,e,o,i){var a=!!i&&!!i.unsafe,c=!!i&&!!i.enumerable,u=!!i&&!!i.noTargetGet;"function"==typeof o&&("string"!=typeof e||_(o,"name")||T(o,"name",e),n(o).source=r.join("string"==typeof e?e:"")),t!==v?(a?!u&&t[e]&&(c=!0):delete t[e],c?t[e]=o:T(t,e,o)):c?t[e]=o:A(e,o)})(Function.prototype,"toString",function(){return"function"==typeof this&&e(this).source||St(this)})}),Dt=tt.concat("length","prototype"),Ft={f:Object.getOwnPropertyNames||function(t){return Z(t,Dt)}},Wt={f:Object.getOwnPropertySymbols},Gt=it("Reflect","ownKeys")||function(t){var e=Ft.f(S(t)),n=Wt.f;return n?e.concat(n(t)):e},Vt=function(t,e){for(var n=Gt(e),r=j.f,o=Nt.f,i=0;i<n.length;i++){var a=n[i];_(t,a)||r(t,a,o(e,a))}},qt=/#|\.prototype\./,Bt=function(t,e){var n=Kt[Ht(t)];return n==Yt||n!=Xt&&("function"==typeof e?o(e):!!e)},Ht=Bt.normalize=function(t){return String(t).replace(qt,".").toLowerCase()},Kt=Bt.data={},Xt=Bt.NATIVE="N",Yt=Bt.POLYFILL="P",zt=Bt,Jt=Nt.f,Qt=function(t,e){var n,r,o,i,a,c=t.target,u=t.global,s=t.stat;if(n=u?v:s?v[c]||A(c,{}):(v[c]||{}).prototype)for(r in e){if(i=e[r],o=t.noTargetGet?(a=Jt(n,r))&&a.value:n[r],!zt(u?r:c+(s?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Vt(i,o)}(t.sham||o&&o.sham)&&T(i,"sham",!0),Ut(n,r,i,t)}},Zt=function(t){return Object(s(t))},te=!o(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),ee=ut("IE_PROTO"),ne=Object.prototype,re=te?Object.getPrototypeOf:function(t){return t=Zt(t),_(t,ee)?t[ee]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ne:null},oe=W("iterator"),ie=!1;[].keys&&("next"in(Ct=[].keys())?(It=re(re(Ct)))!==Object.prototype&&(Rt=It):ie=!0),null==Rt&&(Rt={}),_(Rt,oe)||T(Rt,oe,function(){return this});var ae={IteratorPrototype:Rt,BUGGY_SAFARI_ITERATORS:ie},ce=j.f,ue=W("toStringTag"),se=function(t,e,n){t&&!_(t=n?t:t.prototype,ue)&&ce(t,ue,{configurable:!0,value:e})},le=ae.IteratorPrototype,fe=function(){return this},pe=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return S(n),function(t){if(!y(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(r),e?t.call(n,r):n.__proto__=r,n}}():void 0),he=ae.IteratorPrototype,de=ae.BUGGY_SAFARI_ITERATORS,ve=W("iterator"),ge=function(){return this},ye=_t.set,me=_t.getterFor("Array Iterator"),we=function(t,e,n,r,o,i,a){!function(t,e,n){t.prototype=ht(le,{next:P(1,function(){var t=me(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}})}),se(t,"Array Iterator",!1),yt["Array Iterator"]=fe}(n);var c,u,s,l=function(t){if("values"===t&&d)return d;if(!de&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},f=!1,p=t.prototype,h=p[ve]||p["@@iterator"]||p.values,d=!de&&h||l("values"),v=p.entries||h;if(v&&(c=re(v.call(new t)),he!==Object.prototype&&c.next&&(re(c)!==he&&(pe?pe(c,he):"function"!=typeof c[ve]&&T(c,ve,ge)),se(c,"Array Iterator",!0))),h&&"values"!==h.name&&(f=!0,d=function(){return h.call(this)}),p[ve]!==d&&T(p,ve,d),yt.Array=d,void(u={values:l("values"),keys:l("keys"),entries:l("entries")}))for(s in u)(de||f||!(s in p))&&Ut(p,s,u[s]);else Qt({target:"Array",proto:!0,forced:de||f},u);return u}(Array,0,function(t,e){ye(this,{type:"Array Iterator",target:l(t),index:0,kind:e})});yt.Arguments=yt.Array,gt("keys"),gt("values"),gt("entries");var be=v.Promise,xe=W("species"),Se=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},Ee=W("iterator"),Oe=Array.prototype,je=function(t,e,n){if(Se(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}},Pe={};Pe[W("toStringTag")]="z";var Te="[object z]"===String(Pe),Ae=W("toStringTag"),Re="Arguments"==a(function(){return arguments}()),Ie=Te?a:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Ae))?n:Re?a(e):"Object"==(r=a(e))&&"function"==typeof e.callee?"Arguments":r},Ce=W("iterator"),_e=function(t,e,n,r){try{return r?e(S(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&S(o.call(t)),e}},$e=p(function(t){var e=function(t,e){this.stopped=t,this.result=e};(t.exports=function(t,n,r,o,i){var a,c,u,s,l,f,p,h,d=je(n,r,o?2:1);if(i)a=t;else{if("function"!=typeof(c=function(t){if(null!=t)return t[Ce]||t["@@iterator"]||yt[Ie(t)]}(t)))throw TypeError("Target is not iterable");if(void 0!==(h=c)&&(yt.Array===h||Oe[Ee]===h)){for(u=0,s=H(t.length);s>u;u++)if((l=o?d(S(p=t[u])[0],p[1]):d(t[u]))&&l instanceof e)return l;return new e(!1)}a=c.call(t)}for(f=a.next;!(p=f.call(a)).done;)if("object"==typeof(l=_e(a,d,p.value,o))&&l&&l instanceof e)return l;return new e(!1)}).stop=function(t){return new e(!0,t)}}),ke=W("iterator"),Le=!1;try{var Me=0,Ne={next:function(){return{done:!!Me++}},return:function(){Le=!0}};Ne[ke]=function(){return this},Array.from(Ne,function(){throw 2})}catch(t){}var Ue,De,Fe,We=W("species"),Ge=function(t,e){var n,r=S(t).constructor;return void 0===r||null==(n=S(r)[We])?e:Se(n)},Ve=it("navigator","userAgent")||"",qe=/(iphone|ipod|ipad).*applewebkit/i.test(Ve),Be=v.location,He=v.setImmediate,Ke=v.clearImmediate,Xe=v.process,Ye=v.MessageChannel,ze=v.Dispatch,Je=0,Qe={},Ze=function(t){if(Qe.hasOwnProperty(t)){var e=Qe[t];delete Qe[t],e()}},tn=function(t){return function(){Ze(t)}},en=function(t){Ze(t.data)},nn=function(t){v.postMessage(t+"",Be.protocol+"//"+Be.host)};He&&Ke||(He=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return Qe[++Je]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},Ue(Je),Je},Ke=function(t){delete Qe[t]},"process"==a(Xe)?Ue=function(t){Xe.nextTick(tn(t))}:ze&&ze.now?Ue=function(t){ze.now(tn(t))}:Ye&&!qe?(Fe=(De=new Ye).port2,De.port1.onmessage=en,Ue=je(Fe.postMessage,Fe,1)):!v.addEventListener||"function"!=typeof postMessage||v.importScripts||o(nn)||"file:"===Be.protocol?Ue="onreadystatechange"in b("script")?function(t){at.appendChild(b("script")).onreadystatechange=function(){at.removeChild(this),Ze(t)}}:function(t){setTimeout(tn(t),0)}:(Ue=nn,v.addEventListener("message",en,!1)));var rn,on,an,cn,un,sn,ln,fn,pn={set:He,clear:Ke},hn=Nt.f,dn=pn.set,vn=v.MutationObserver||v.WebKitMutationObserver,gn=v.process,yn=v.Promise,mn="process"==a(gn),wn=hn(v,"queueMicrotask"),bn=wn&&wn.value;bn||(rn=function(){var t,e;for(mn&&(t=gn.domain)&&t.exit();on;){e=on.fn,on=on.next;try{e()}catch(t){throw on?cn():an=void 0,t}}an=void 0,t&&t.enter()},mn?cn=function(){gn.nextTick(rn)}:vn&&!qe?(un=!0,sn=document.createTextNode(""),new vn(rn).observe(sn,{characterData:!0}),cn=function(){sn.data=un=!un}):yn&&yn.resolve?(ln=yn.resolve(void 0),fn=ln.then,cn=function(){fn.call(ln,rn)}):cn=function(){dn.call(v,rn)});var xn,Sn,En=bn||function(t){var e={fn:t,next:void 0};an&&(an.next=e),on||(on=e,cn()),an=e},On=function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=Se(e),this.reject=Se(n)},jn={f:function(t){return new On(t)}},Pn=function(t,e){if(S(t),y(e)&&e.constructor===t)return e;var n=jn.f(t);return(0,n.resolve)(e),n.promise},Tn=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},An=v.process,Rn=An&&An.versions,In=Rn&&Rn.v8;In?Sn=(xn=In.split("."))[0]+xn[1]:Ve&&(!(xn=Ve.match(/Edge\/(\d+)/))||xn[1]>=74)&&(xn=Ve.match(/Chrome\/(\d+)/))&&(Sn=xn[1]);var Cn,_n,$n,kn,Ln,Mn=Sn&&+Sn,Nn=pn.set,Un=W("species"),Dn=_t.get,Fn=_t.set,Wn=_t.getterFor("Promise"),Gn=be,Vn=v.TypeError,qn=v.document,Bn=v.process,Hn=it("fetch"),Kn=jn.f,Xn=Kn,Yn="process"==a(Bn),zn=!!(qn&&qn.createEvent&&v.dispatchEvent),Jn=zt("Promise",function(){if(St(Gn)===String(Gn)){if(66===Mn)return!0;if(!Yn&&"function"!=typeof PromiseRejectionEvent)return!0}if(Mn>=51&&/native code/.test(Gn))return!1;var t=Gn.resolve(1),e=function(t){t(function(){},function(){})};return(t.constructor={})[Un]=e,!(t.then(function(){})instanceof e)}),Qn=Jn||!function(t,e){if(!Le)return!1;var n=!1;try{var r={};r[ke]=function(){return{next:function(){return{done:n=!0}}}},Gn.all(r).catch(function(){})}catch(t){}return n}(),Zn=function(t){var e;return!(!y(t)||"function"!=typeof(e=t.then))&&e},tr=function(t,e,n){if(!e.notified){e.notified=!0;var r=e.reactions;En(function(){for(var o=e.value,i=1==e.state,a=0;r.length>a;){var c,u,s,l=r[a++],f=i?l.ok:l.fail,p=l.resolve,h=l.reject,d=l.domain;try{f?(i||(2===e.rejection&&or(t,e),e.rejection=1),!0===f?c=o:(d&&d.enter(),c=f(o),d&&(d.exit(),s=!0)),c===l.promise?h(Vn("Promise-chain cycle")):(u=Zn(c))?u.call(c,p,h):p(c)):h(o)}catch(t){d&&!s&&d.exit(),h(t)}}e.reactions=[],e.notified=!1,n&&!e.rejection&&nr(t,e)})}},er=function(t,e,n){var r,o;zn?((r=qn.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),v.dispatchEvent(r)):r={promise:e,reason:n},(o=v["on"+t])?o(r):"unhandledrejection"===t&&function(t,e){var n=v.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}("Unhandled promise rejection",n)},nr=function(t,e){Nn.call(v,function(){var n,r=e.value;if(rr(e)&&(n=Tn(function(){Yn?Bn.emit("unhandledRejection",r,t):er("unhandledrejection",t,r)}),e.rejection=Yn||rr(e)?2:1,n.error))throw n.value})},rr=function(t){return 1!==t.rejection&&!t.parent},or=function(t,e){Nn.call(v,function(){Yn?Bn.emit("rejectionHandled",t):er("rejectionhandled",t,e.value)})},ir=function(t,e,n,r){return function(o){t(e,n,o,r)}},ar=function(t,e,n,r){e.done||(e.done=!0,r&&(e=r),e.value=n,e.state=2,tr(t,e,!0))},cr=function(t,e,n,r){if(!e.done){e.done=!0,r&&(e=r);try{if(t===n)throw Vn("Promise can't be resolved itself");var o=Zn(n);o?En(function(){var r={done:!1};try{o.call(n,ir(cr,t,r,e),ir(ar,t,r,e))}catch(n){ar(t,r,n,e)}}):(e.value=n,e.state=1,tr(t,e,!1))}catch(n){ar(t,{done:!1},n,e)}}};Jn&&(Gn=function(t){!function(t,e,n){if(!(t instanceof Gn))throw TypeError("Incorrect Promise invocation")}(this),Se(t),Cn.call(this);var e=Dn(this);try{t(ir(cr,this,e),ir(ar,this,e))}catch(t){ar(this,e,t)}},(Cn=function(t){Fn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(t,e,n){for(var r in e)Ut(t,r,e[r],void 0);return t}(Gn.prototype,{then:function(t,e){var n=Wn(this),r=Kn(Ge(this,Gn));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=Yn?Bn.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&tr(this,n,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),_n=function(){var t=new Cn,e=Dn(t);this.promise=t,this.resolve=ir(cr,t,e),this.reject=ir(ar,t,e)},jn.f=Kn=function(t){return t===Gn||t===$n?new _n(t):Xn(t)},"function"==typeof be&&(kn=be.prototype.then,Ut(be.prototype,"then",function(t,e){var n=this;return new Gn(function(t,e){kn.call(n,t,e)}).then(t,e)},{unsafe:!0}),"function"==typeof Hn&&Qt({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return Pn(Gn,Hn.apply(v,arguments))}}))),Qt({global:!0,wrap:!0,forced:Jn},{Promise:Gn}),se(Gn,"Promise",!1),Ln=it("Promise"),g&&Ln&&!Ln[xe]&&(0,j.f)(Ln,xe,{configurable:!0,get:function(){return this}}),$n=it("Promise"),Qt({target:"Promise",stat:!0,forced:Jn},{reject:function(t){var e=Kn(this);return e.reject.call(void 0,t),e.promise}}),Qt({target:"Promise",stat:!0,forced:Jn},{resolve:function(t){return Pn(this,t)}}),Qt({target:"Promise",stat:!0,forced:Qn},{all:function(t){var e=this,n=Kn(e),r=n.resolve,o=n.reject,i=Tn(function(){var n=Se(e.resolve),i=[],a=0,c=1;$e(t,function(t){var u=a++,s=!1;i.push(void 0),c++,n.call(e,t).then(function(t){s||(s=!0,i[u]=t,--c||r(i))},o)}),--c||r(i)});return i.error&&o(i.value),n.promise},race:function(t){var e=this,n=Kn(e),r=n.reject,o=Tn(function(){var o=Se(e.resolve);$e(t,function(t){o.call(e,t).then(n.resolve,r)})});return o.error&&r(o.value),n.promise}});var ur,sr=W("match"),lr=function(t){var e;return y(t)&&(void 0!==(e=t[sr])?!!e:"RegExp"==a(t))},fr=function(t){if(lr(t))throw TypeError("The method doesn't accept regular expressions");return t},pr=W("match"),hr=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[pr]=!1,"/./"[t](e)}catch(t){}}return!1},dr=Nt.f,vr="".startsWith,gr=Math.min,yr=hr("startsWith"),mr=!(yr||(ur=dr(String.prototype,"startsWith"),!ur||ur.writable));Qt({target:"String",proto:!0,forced:!mr&&!yr},{startsWith:function(t){var e=String(s(this));fr(t);var n=H(gr(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return vr?vr.call(e,r,n):e.slice(n,n+r.length)===r}});var wr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},br=W("iterator"),xr=W("toStringTag"),Sr=we.values;for(var Er in wr){var Or=v[Er],jr=Or&&Or.prototype;if(jr){if(jr[br]!==Sr)try{T(jr,br,Sr)}catch(t){jr[br]=Sr}if(jr[xr]||T(jr,xr,Er),wr[Er])for(var Pr in we)if(jr[Pr]!==we[Pr])try{T(jr,Pr,we[Pr])}catch(t){jr[Pr]=we[Pr]}}}var Tr=function(){var t=S(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e},Ar=RegExp.prototype,Rr=Ar.toString;(o(function(){return"/a/b"!=Rr.call({source:"a",flags:"b"})})||"toString"!=Rr.name)&&Ut(RegExp.prototype,"toString",function(){var t=S(this),e=String(t.source),n=t.flags;return"/"+e+"/"+String(void 0===n&&t instanceof RegExp&&!("flags"in Ar)?Tr.call(t):n)},{unsafe:!0});var Ir="\t\n\v\f\r                　\u2028\u2029\ufeff",Cr="["+Ir+"]",_r=RegExp("^"+Cr+Cr+"*"),$r=RegExp(Cr+Cr+"*$"),kr=function(t){return function(e){var n=String(s(e));return 1&t&&(n=n.replace(_r,"")),2&t&&(n=n.replace($r,"")),n}},Lr={start:kr(1),end:kr(2),trim:kr(3)},Mr=function(t){return o(function(){return!!Ir[t]()||"​᠎"!="​᠎"[t]()||Ir[t].name!==t})},Nr=Lr.trim;function Ur(e){return t.trim(null==e?void 0:e.trim(),"​")}Qt({target:"String",proto:!0,forced:Mr("trim")},{trim:function(){return Nr(this)}});const Dr=!("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))&&"undefined"!=typeof window;function Fr(t,e){return RegExp(t,e)}var Wr,Gr,Vr={UNSUPPORTED_Y:o(function(){var t=Fr("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),BROKEN_CARET:o(function(){var t=Fr("^r","gy");return t.lastIndex=2,null!=t.exec("str")})},qr=RegExp.prototype.exec,Br=String.prototype.replace,Hr=qr,Kr=(Gr=/b*/g,qr.call(Wr=/a/,"a"),qr.call(Gr,"a"),0!==Wr.lastIndex||0!==Gr.lastIndex),Xr=Vr.UNSUPPORTED_Y||Vr.BROKEN_CARET,Yr=void 0!==/()??/.exec("")[1];(Kr||Yr||Xr)&&(Hr=function(t){var e,n,r,o,i=this,a=Xr&&i.sticky,c=Tr.call(i),u=i.source,s=0,l=t;return a&&(-1===(c=c.replace("y","")).indexOf("g")&&(c+="g"),l=String(t).slice(i.lastIndex),i.lastIndex>0&&(!i.multiline||i.multiline&&"\n"!==t[i.lastIndex-1])&&(u="(?: "+u+")",l=" "+l,s++),n=new RegExp("^(?:"+u+")",c)),Yr&&(n=new RegExp("^"+u+"$(?!\\s)",c)),Kr&&(e=i.lastIndex),r=qr.call(a?n:i,l),a?r?(r.input=r.input.slice(s),r[0]=r[0].slice(s),r.index=i.lastIndex,i.lastIndex+=r[0].length):i.lastIndex=0:Kr&&r&&(i.lastIndex=i.global?r.index+r[0].length:e),Yr&&r&&r.length>1&&Br.call(r[0],n,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)}),r});var zr=Hr;Qt({target:"RegExp",proto:!0,forced:/./.exec!==zr},{exec:zr});var Jr=W("species"),Qr=!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),Zr="$0"==="a".replace(/./,"$0"),to=W("replace"),eo=!!/./[to]&&""===/./[to]("a","$0"),no=!o(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}),ro=function(t,e,n,r){var i=W(t),a=!o(function(){var e={};return e[i]=function(){return 7},7!=""[t](e)}),c=a&&!o(function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[Jr]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return e=!0,null},n[i](""),!e});if(!a||!c||"replace"===t&&(!Qr||!Zr||eo)||"split"===t&&!no){var u=/./[i],s=n(i,""[t],function(t,e,n,r,o){return e.exec===zr?a&&!o?{done:!0,value:u.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}},{REPLACE_KEEPS_$0:Zr,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:eo}),l=s[1];Ut(String.prototype,t,s[0]),Ut(RegExp.prototype,i,2==e?function(t,e){return l.call(t,this,e)}:function(t){return l.call(t,this)})}r&&T(RegExp.prototype[i],"sham",!0)},oo=function(t){return function(e,n){var r,o,i=String(s(e)),a=q(n),c=i.length;return a<0||a>=c?t?"":void 0:(r=i.charCodeAt(a))<55296||r>56319||a+1===c||(o=i.charCodeAt(a+1))<56320||o>57343?t?i.charAt(a):r:t?i.slice(a,a+2):o-56320+(r-55296<<10)+65536}},io=(oo(!1),oo(!0)),ao=function(t,e,n){return e+(n?io(t,e).length:1)},co=function(t,e){var n=t.exec;if("function"==typeof n){var r=n.call(t,e);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==a(t))throw TypeError("RegExp#exec called on incompatible receiver");return zr.call(t,e)},uo=Math.max,so=Math.min,lo=Math.floor,fo=/\$([$&'`]|\d\d?|<[^>]*>)/g,po=/\$([$&'`]|\d\d?)/g;ro("replace",2,function(t,e,n,r){var o=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,i=r.REPLACE_KEEPS_$0,a=o?"$":"$0";return[function(n,r){var o=s(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,o,r):e.call(String(o),n,r)},function(t,r){if(!o&&i||"string"==typeof r&&-1===r.indexOf(a)){var u=n(e,t,this,r);if(u.done)return u.value}var s=S(t),l=String(this),f="function"==typeof r;f||(r=String(r));var p=s.global;if(p){var h=s.unicode;s.lastIndex=0}for(var d=[];;){var v=co(s,l);if(null===v)break;if(d.push(v),!p)break;""===String(v[0])&&(s.lastIndex=ao(l,H(s.lastIndex),h))}for(var g,y="",m=0,w=0;w<d.length;w++){v=d[w];for(var b=String(v[0]),x=uo(so(q(v.index),l.length),0),E=[],O=1;O<v.length;O++)E.push(void 0===(g=v[O])?g:String(g));var j=v.groups;if(f){var P=[b].concat(E,x,l);void 0!==j&&P.push(j);var T=String(r.apply(void 0,P))}else T=c(b,l,x,E,j,r);x>=m&&(y+=l.slice(m,x)+T,m=x+b.length)}return y+l.slice(m)}];function c(t,n,r,o,i,a){var c=r+t.length,u=o.length,s=po;return void 0!==i&&(i=Zt(i),s=fo),e.call(a,s,function(e,a){var s;switch(a.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=i[a.slice(1,-1)];break;default:var l=+a;if(0===l)return e;if(l>u){var f=lo(l/10);return 0===f?e:f<=u?void 0===o[f-1]?a.charAt(1):o[f-1]+a.charAt(1):e}s=o[l-1]}return void 0===s?"":s})}});var ho,vo=Object.defineProperty,go={},yo=function(t){throw t},mo=z.indexOf,wo=[].indexOf,bo=!!wo&&1/[1].indexOf(1,-0)<0,xo=!!(ho=[].indexOf)&&o(function(){ho.call(null,function(){throw 1},1)}),So=function(t,e){if(_(go,"indexOf"))return go.indexOf;e||(e={});var n=[].indexOf,r=!!_(e,"ACCESSORS")&&e.ACCESSORS,i=_(e,0)?e[0]:yo,a=_(e,1)?e[1]:void 0;return go.indexOf=!!n&&!o(function(){if(r&&!g)return!0;var t={length:-1};r?vo(t,1,{enumerable:!0,get:yo}):t[1]=1,n.call(t,i,a)})}(0,{ACCESSORS:!0,1:0});Qt({target:"Array",proto:!0,forced:bo||!xo||!So},{indexOf:function(t){return bo?wo.apply(this,arguments)||0:mo(this,t,arguments.length>1?arguments[1]:void 0)}});var Eo=Object.assign,Oo=Object.defineProperty,jo=!Eo||o(function(){if(g&&1!==Eo({b:1},Eo(Oo({},"a",{enumerable:!0,get:function(){Oo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=Eo({},t)[n]||"abcdefghijklmnopqrst"!=et(Eo({},e)).join("")})?function(t,e){for(var n=Zt(t),r=arguments.length,o=1,i=Wt.f,a=Lt.f;r>o;)for(var c,s=u(arguments[o++]),l=i?et(s).concat(i(s)):et(s),f=l.length,p=0;f>p;)c=l[p++],g&&!a.call(s,c)||(n[c]=s[c]);return n}:Eo;Qt({target:"Object",stat:!0,forced:Object.assign!==jo},{assign:jo});var Po=Nt.f,To="".endsWith,Ao=Math.min,Ro=hr("endsWith"),Io=!Ro&&!!function(){var t=Po(String.prototype,"endsWith");return t&&!t.writable}();Qt({target:"String",proto:!0,forced:!Io&&!Ro},{endsWith:function(t){var e=String(s(this));fr(t);var n=arguments.length>1?arguments[1]:void 0,r=H(e.length),o=void 0===n?r:Ao(H(n),r),i=String(t);return To?To.call(e,i,o):e.slice(o-i.length,o)===i}});var Co=[].push,_o=Math.min,$o=!o(function(){return!RegExp(4294967295,"y")});ro("split",2,function(t,e,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var r=String(s(this)),o=void 0===n?4294967295:n>>>0;if(0===o)return[];if(void 0===t)return[r];if(!lr(t))return e.call(r,t,o);for(var i,a,c,u=[],l=0,f=new RegExp(t.source,(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":"")+"g");(i=zr.call(f,r))&&!((a=f.lastIndex)>l&&(u.push(r.slice(l,i.index)),i.length>1&&i.index<r.length&&Co.apply(u,i.slice(1)),c=i[0].length,l=a,u.length>=o));)f.lastIndex===i.index&&f.lastIndex++;return l===r.length?!c&&f.test("")||u.push(""):u.push(r.slice(l)),u.length>o?u.slice(0,o):u}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var o=s(this),i=null==e?void 0:e[t];return void 0!==i?i.call(e,o,n):r.call(String(o),e,n)},function(t,o){var i=n(r,t,this,o,r!==e);if(i.done)return i.value;var a=S(t),c=String(this),u=Ge(a,RegExp),s=a.unicode,l=new u($o?a:"^(?:"+a.source+")",(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+($o?"y":"g")),f=void 0===o?4294967295:o>>>0;if(0===f)return[];if(0===c.length)return null===co(l,c)?[c]:[];for(var p=0,h=0,d=[];h<c.length;){l.lastIndex=$o?h:0;var v,g=co(l,$o?c:c.slice(h));if(null===g||(v=_o(H(l.lastIndex+($o?0:h)),c.length))===p)h=ao(c,h,s);else{if(d.push(c.slice(p,h)),d.length===f)return d;for(var y=1;y<=g.length-1;y++)if(d.push(g[y]),d.length===f)return d;h=p=v}}return d.push(c.slice(p)),d}]},!$o);var ko=Lr.end,Lo=Mr("trimEnd"),Mo=Lo?function(){return ko(this)}:"".trimEnd;Qt({target:"String",proto:!0,forced:Lo},{trimEnd:Mo,trimRight:Mo});var No=Lr.start,Uo=Mr("trimStart"),Do=Uo?function(){return No(this)}:"".trimStart;Qt({target:"String",proto:!0,forced:Uo},{trimStart:Do,trimLeft:Do});const Fo=encodeURIComponent;function Wo(t){return t&&t.startsWith("'")?t.substr(1,t.length-2):t}const Go={type:"audio",name:"forvo",url:"https://forvo.com",makeUrl:({text:t,lang:e})=>`https://ru.forvo.com/word/${Fo(t)}/#${e}`,plan:[{selector:"article.pronunciations ul.show-all-pronunciations li",parse:async n=>{const r=(await n.$$("span.play"))[0];if(!r)return;const o=function(t){if(!t)return;const e=t.indexOf("("),n=t.indexOf(")");return{name:t.substr(0,e),args:t.substr(e+1,n-e-1).split(",").map(Wo)}}(await r.getAttribute("onclick"));if(!o||"Play"!==o.name)return;const i="https://audio00.forvo.com/audios/mp3/"+e.decode(o.args[4]);if(!i.endsWith(".mp3"))return;const a={url:i},c=(await n.$$("span.ofLink"))[0];if(c){const t=await c.getAttribute("data-p2");t&&(a.author=t)}const u=(await n.$$("span.from"))[0];if(u){const e=function(e){if(!e)return;const n=(e=t.trimEnd(t.trimStart(e,"("),")")).split(",");if(t.isEmpty(n))return;const r={gender:(o=n[0],"женщина"===(o=Ur(o))?"f":"мужчина"===o?"m":o)};var o;return 2===n.length&&(r.country=function(t){return Ur(t)}(n[1])),r}(await u.textContent());e&&Object.assign(a,e)}return[{audio:a}]}}]},Vo={type:"audio",name:"howjsay",url:"https://howjsay.com",getData:async({text:t})=>({audio:[{url:`https://howjsay.com/mp3/${encodeURIComponent(t)}.mp3`}]})};class qo{constructor(t,e){this.$=t,this.elem=e}async $$(t){const e=this.elem.find(t),n=[];return e.each((t,e)=>{n.push(new qo(this.$,this.$(e)))}),n}async getAttribute(t){return this.elem.attr(t)}async textContent(){return this.elem.text()}}class Bo{constructor(t){this.$=r.load(t)}$$(t){const e=this.$(t),n=[];return e.each((t,e)=>{n.push(new qo(this.$,this.$(e)))}),Promise.resolve(n)}close(){return Promise.resolve(void 0)}}async function Ho(t){Dr&&(t="https://api.allorigins.win/raw?url="+encodeURIComponent(t));const e=await n(t,{headers:{"User-Agent":"lingua-bot",Accept:"text/html,application/xhtml+xml"}});if(!e.ok)throw new Error(e.statusText);const r=await e.text();return new Bo(r)}class Ko{constructor(t,e){this.page=t,this.elem=e}async $$(t){return(await this.elem.$$(t)).map(t=>new Ko(this.page,t))}getAttribute(t){return this.elem.getAttribute(t)}textContent(){return this.elem.textContent()}}class Xo{constructor(t,e){this.browser=t,this.page=e}async $$(t){try{await this.page.waitForSelector(t,{timeout:5e3})}catch(t){}return(await this.page.$$(t)).map(t=>new Ko(this.page,t))}async close(){await this.page.close(),await this.browser.close()}}const Yo=[{type:"visual",name:"unsplash",url:"https://unsplash.com",makeUrl:({text:t})=>"/s/photos/"+t.replace(" ","-"),plan:[{selector:'div[data-test="search-photos-route"] figure img',exclude:["^https://images.unsplash.com/profile-"],visual:["@src"]}]},{type:"universal",engine:"playwright",name:"wordnik",url:"https://www.wordnik.com",makeUrl:({text:t})=>"/words/"+t,plan:[{selector:".flickr-module .thumbs img",visual:["@src"]}]},{type:"universal",name:"macmillan",url:"https://www.macmillandictionary.com",makeUrl:({text:t})=>"/dictionary/british/"+t,plan:[{selector:".PRON",term:"transcription"},{selector:".PART-OF-SPEECH",term:"tag"},{selector:".SYNTAX-CODING",term:"tag"},{selector:".DEFINITION",term:"definition"},{selector:".EXAMPLES",term:"in"},{selector:".PHR-XREF",term:"in"},{selector:".synonyms .theslink",exclude:["..."],term:"synonym"},{selector:".audio_play_button",audio:["@data-src-mp3","@data-src-ogg"]}]},Go,Vo];function zo(e){return async({text:n,lang:r})=>{const o={text:n,lang:r||"en"};if(e.getData)try{const t=await e.getData(o);return{source:{name:e.name,url:e.url},data:t}}catch(t){return console.log("error",e.name,t),{source:{name:e.name,url:e.url},error:t}}let i=e.makeUrl(o);i.startsWith("/")&&(i=e.url+i);try{const n=await function(t,e){return"playwright"===t?async function(t){if(Dr)return await Ho(t);const{chromium:e}=require("playwright"),n=await e.launch(),r=await n.newPage();return await r.goto(t),new Xo(n,r)}(e):Ho(e)}(e.engine,i);return async function(e,n,r){const o={},i=t=>{t&&!o[t]&&(o[t]=new Set)},a=async(e,r,a)=>{i(e);const c=e?o[e]:void 0,u=await n.$$(r.selector);for(const e of u){const n=await a(r,e);if(Array.isArray(n))for(const e of n.filter(e=>!t.isNil(e)&&""!==e))c?c.add(e):t.forEach(e,(t,e)=>{i(e),o[e].add(t)})}},c=(t,e)=>!!t.exclude&&t.exclude.some(t=>t.startsWith("^")?e.startsWith(t.substr(1)):e===t),u=async(t,e)=>{const n=Ur(await e.textContent());if(n&&!c(t,n))return[n]},s=async(t,e,n)=>{const r=[];for(const o of n){let n;n=o.startsWith("@")?await e.getAttribute(o.substr(1)):Ur(await e.text()),c(t,n)||r.push(n)}return 0===r.length?void 0:r},l=async(t,e)=>await s(t,e,t.audio),f=async(t,e)=>await s(t,e,t.visual),p=(t,e)=>t.parse(e);for(const t of e.plan)t.term?await a(t.term,t,u):t.audio?await a("audio",t,l):t.visual?await a("visual",t,f):t.parse&&await a(void 0,t,p);return{source:{name:e.name,url:e.url},data:t.mapValues(o,t=>Array.from(t))}}(e,n)}catch(t){return console.log("error",e.name,t),{source:{name:e.name,url:e.url},error:t}}}}function Jo(e,n={}){const r=n.sources||Yo.filter(e=>n.type?e.type===n.type||"universal"===e.type:!!t.isEmpty(n.include)||n.include.some(t=>e.name.toLowerCase()===t.toLowerCase()));return Promise.all(r.map(zo).map(t=>t(e)))}export{Jo as fetchData,Yo as sources};
//# sourceMappingURL=bundle.modern.js.map
